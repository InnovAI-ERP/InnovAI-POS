!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="aaaa9fba-0094-45ad-a9c6-9cabb0ed34a8",e._sentryDebugIdIdentifier="sentry-dbid-aaaa9fba-0094-45ad-a9c6-9cabb0ed34a8")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5323,6106],{955:(e,t,a)=>{"use strict";a.d(t,{A:()=>p,U:()=>m});var s=a(80263),r=a(53434),i=a.n(r),l=a(68656),n=a(53239),o=a(58897),d=a(33656),c=a(16601),u=a(2);let m=e=>{var t;let{onChange:a,value:r,options:m,className:p,loading:h,currentBillingPeriodStart:g,currentBillingPeriodEnd:f,footer:y}=e,[x,v]=(0,n.useState)(r);(0,n.useEffect)(()=>{A(r)},[h]);let b=i()().startOf("month").format(o.DX),_=i()().add(1,"month").startOf("month").format(o.DX),j=i()().format(o.DX);function A(e){switch(v(e),e){case"currentBillingCycle":a({period_start:{date:i().unix(null!=g?g:0).format(o.DX),time_period:"1d"},period_end:{date:i().unix(null!=f?f:0).format(o.DX),time_period:"today"},interval:"1d"});break;case"previousBillingCycle":a({period_start:{date:i().unix(null!=g?g:0).subtract(1,"month").format(o.DX),time_period:"1d"},period_end:{date:i().unix(null!=g?g:0).format(o.DX),time_period:"today"},interval:"1d"});break;case"10m":a({period_start:{date:i()().subtract(10,"minutes").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"30m":a({period_start:{date:i()().subtract(30,"minutes").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"1d":a({period_start:{date:i()().subtract(24,"hour").format(o.DX),time_period:"1d"},period_end:{date:j,time_period:"today"},interval:"1h"});break;case"3h":a({period_start:{date:i()().subtract(3,"hour").format(o.DX),time_period:"3h"},period_end:{date:j,time_period:"today"},interval:"5m"});break;case"1h":a({period_start:{date:i()().subtract(1,"hour").format(o.DX),time_period:"1h"},period_end:{date:j,time_period:"today"},interval:"1m"});break;case"7d":a({period_start:{date:i()().subtract(7,"day").format(o.DX),time_period:"7d"},period_end:{date:j,time_period:"today"},interval:"1d"});break;case"30d":a({period_start:{date:i()().subtract(30,"day").format(o.DX),time_period:"30d"},period_end:{date:j,time_period:"today"},interval:"1d"});break;case"60d":a({period_start:{date:i()().subtract(60,"day").format(o.DX),time_period:"60d"},period_end:{date:j,time_period:"today"},interval:"3d"});break;case"startMonth":a({period_start:{date:b,time_period:"startMonth"},period_end:{date:_,time_period:"endMonth"},interval:"1d"});break;default:console.warn("Unknown period encountered: ".concat(e))}}return(0,s.jsxs)(d.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"DateRangePicker","data-sentry-source-file":"DateRangePicker.tsx",children:[(0,s.jsx)(d.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"DateRangePicker.tsx",children:(0,s.jsx)(c.$,{type:"default",iconRight:(0,s.jsx)(l.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"DateRangePicker.tsx",children:(0,s.jsx)("span",{children:x&&(null==(t=m.find(e=>e.key===x))?void 0:t.label)})})}),(0,s.jsxs)(d.SQ,{side:"bottom",align:"start",className:(0,u.cn)(!y&&"w-36",p),"data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"DateRangePicker.tsx",children:[(0,s.jsx)(d.Hr,{value:x,onValueChange:e=>A(e),"data-sentry-element":"DropdownMenuRadioGroup","data-sentry-source-file":"DateRangePicker.tsx",children:m.map(e=>(0,s.jsx)(d.Ht,{value:e.key,children:e.label},e.key))}),!!y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.mB,{}),y]})]})]})},p=m},2743:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(47370).A)("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]])},7197:(e,t,a)=>{"use strict";a.d(t,{A:()=>C});var s=a(80263),r=a(60045),i=a(53434),l=a.n(i),n=a(89714),o=a(66452),d=a(63320),c=a.n(d),u=a(73969),m=a(86692),p=a(89044),h=a(45969),g=a(72821),f=a(22392),y=a(25718),x=a(55335),v=a(80109),b=a(98883),_=a(55739),j=a(16601),A=a(97851),k=a(62719);let C=e=>{var t,a,i,d,C;let{visible:w,loading:N,hideModal:S}=e,{ref:I}=(0,p.g)(),{project:P,isLoading:E}=(0,h.Om)(),{lastDatabaseResizeAt:D}=null!=P?P:{},T=(0,y.a)(),{data:R,isLoading:M}=(0,f.j5)({orgSlug:null==T?void 0:T.slug},{enabled:w}),L=null===D?0:360-l()().diff(D,"minutes"),q=L<=0,z=L<60?"".concat(L," minute(s)"):"".concat(Math.floor(L/60)," hours and ").concat(L%60," minute(s)"),{mutate:O,isLoading:B}=(0,g.F)({onSuccess:(e,t)=>{u.oR.success("Successfully updated disk size to ".concat(t.volumeSize," GB")),S(!1)}}),H=async e=>{if(!I)return console.error("Project ref is required");O({projectRef:I,volumeSize:e["new-disk-size"]})},G=null!=(C=null==P?void 0:P.volumeSizeGb)?C:0,U=(0,m.object)({"new-disk-size":(0,m.number)().required("Please enter a GB amount you want to resize the disk up to.").min(Number(null!=G?G:0),"Must be more than ".concat(G," GB")).max(Number(200),"Must not be more than 200 GB")});return(0,s.jsx)(x.A,{header:"Increase Disk Storage Size",size:"medium",visible:w,loading:N,onCancel:()=>S(!1),hideFooter:!0,"data-sentry-element":"Modal","data-sentry-component":"DiskSizeConfigurationModal","data-sentry-source-file":"DiskSizeConfigurationModal.tsx",children:E||M?(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,s.jsx)(k.A,{}),(0,s.jsx)(k.A,{})]}):(null==R?void 0:R.usage_billing_enabled)===!0?(0,s.jsx)(v.A,{name:"disk-resize-form",initialValues:{"new-disk-size":G},validationSchema:U,onSubmit:H,children:()=>G>=200?(0,s.jsxs)(b.Fc,{variant:"warning",className:"rounded-t-none border-0",children:[(0,s.jsx)(_.id,{}),(0,s.jsx)(b.XL,{children:"Maximum manual disk size increase reached"}),(0,s.jsxs)(b.TN,{children:[(0,s.jsxs)("p",{children:["You cannot manually expand the disk size any more than ",200,"GB. If you need more than this, contact us via support for help."]}),(0,s.jsx)(j.$,{asChild:!0,type:"default",className:"mt-3",children:(0,s.jsx)(c(),{href:"/support/new?projectRef=".concat(I,"&category=").concat(r.S.PERFORMANCE_ISSUES,"&subject=Increase%20disk%20size%20beyond%20200GB"),children:"Contact support"})})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(x.A.Content,{className:"w-full space-y-4",children:[(0,s.jsxs)(b.Fc,{variant:q?"default":"warning",children:[(0,s.jsx)(n.A,{size:16}),(0,s.jsx)(b.XL,{children:"This operation is only possible every 6 hours"}),(0,s.jsxs)(b.TN,{children:[(0,s.jsx)("div",{className:"mb-4",children:q?"Upon updating your disk size, the next disk size update will only be available from ".concat(l()().format("DD MMM YYYY, HH:mm (ZZ)")):"Your database was last resized at ".concat(l()(D).format("DD MMM YYYY, HH:mm (ZZ)"),". You can resize your database again in approximately ").concat(z)}),(0,s.jsx)(j.$,{asChild:!0,type:"default",iconRight:(0,s.jsx)(o.A,{size:14}),children:(0,s.jsx)(c(),{href:"https://supabase.com/docs/guides/platform/database-size#disk-management",children:"Read more about disk management"})})]})]}),(0,s.jsx)(A.A,{required:!0,id:"new-disk-size",label:"New disk size",labelOptional:"GB",disabled:!q})]}),(0,s.jsx)(x.A.Separator,{}),(0,s.jsxs)(x.A.Content,{className:"flex space-x-2 justify-end",children:[(0,s.jsx)(j.$,{type:"default",onClick:()=>S(!1),children:"Cancel"}),(0,s.jsx)(j.$,{htmlType:"submit",type:"primary",disabled:!q||B,loading:B,children:"Update disk size"})]})]})}):(0,s.jsxs)(b.Fc,{className:"border-none",children:[(0,s.jsx)(_.mo,{}),(0,s.jsx)(b.XL,{children:(null==R||null==(t=R.plan)?void 0:t.id)==="free"?"Disk size configuration is not available for projects on the Free Plan":"Disk size configuration is only available when the spend cap has been disabled"}),(0,s.jsxs)(b.TN,{children:[(null==R||null==(a=R.plan)?void 0:a.id)==="free"?(0,s.jsx)("p",{children:"If you are intending to use more than 500MB of disk space, then you will need to upgrade to at least the Pro Plan."}):(0,s.jsx)("p",{children:"If you are intending to use more than 8GB of disk space, then you will need to disable your spend cap."}),(0,s.jsx)(j.$,{asChild:!0,type:"default",className:"mt-3",children:(0,s.jsx)(c(),{href:"/org/".concat(null==T?void 0:T.slug,"/billing?panel=").concat((null==R||null==(i=R.plan)?void 0:i.id)==="free"?"subscriptionPlan":"costControl"),target:"_blank",children:(null==R||null==(d=R.plan)?void 0:d.id)==="free"?"Upgrade subscription":"Disable spend cap"})})]})]})})}},8571:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(56947),r=a(32933),i=a(45969),l=a(71433),n=a(77570),o=a(33887);let d=e=>{var t;let{sql:a,params:d=r.EV,where:c,orderBy:u}=e,{project:m}=(0,i.Om)(),p=(0,o.RE)(),{data:h}=(0,l.Vh)({projectRef:null==m?void 0:m.ref}),g=null==(t=(h||[]).find(e=>e.identifier===p.selectedDatabaseId))?void 0:t.connectionString,f=p.selectedDatabaseId,y="function"==typeof a?a([]):a,{data:x,error:v,isLoading:b,isRefetching:_,refetch:j}=(0,s.I)(["projects",null==m?void 0:m.ref,"db",{...d,sql:y,identifier:f},c,u],e=>{let{signal:t}=e;return(0,n.E)({projectRef:null==m?void 0:m.ref,connectionString:g||(null==m?void 0:m.connectionString),sql:y},t).then(e=>e.result)},{enabled:!!y,refetchOnWindowFocus:!1,refetchOnReconnect:!1});return{error:v||("object"==typeof x?null==x?void 0:x.error:""),data:x,isLoading:b,isRefetching:_,params:d,runQuery:j,resolvedSql:y}}},8594:(e,t,a)=>{"use strict";a.d(t,{Q:()=>o});var s=a(31572),r=a(98140),i=a(53190),l=a(42417),n=a(19128),o=(0,s.gu)({chartName:"AreaChart",GraphicalChild:r.G,axisComponents:[{axisType:"xAxis",AxisComp:i.W},{axisType:"yAxis",AxisComp:l.h}],formatAxisMap:n.pr})},11558:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(56947),r=a(53239),i=a(89044),l=a(66933),n=a(92589),o=a(3807);let d=function(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=!(arguments.length>2)||void 0===arguments[2]||arguments[2],c=(0,l.Et)(l.Po),[u,m]=(0,r.useState)({sql:(null==a?void 0:a.sql)||"",project:e,iso_timestamp_start:a.iso_timestamp_start?a.iso_timestamp_start:c.calcFrom(),iso_timestamp_end:a.iso_timestamp_end?a.iso_timestamp_end:c.calcTo()}),p=d&&void 0!==e&&!!u.sql,h=(0,n.Fx)(u.sql||""),g=(0,n.n4)(u.sql||""),{data:f,error:y,isLoading:x,isRefetching:v,refetch:b}=(0,s.I)(["projects",e,"logs",u],async t=>{let{signal:a}=t,{data:s,error:r}=await (0,o.Jt)("/platform/projects/{ref}/analytics/endpoints/logs.all",{params:{path:{ref:e},query:u},signal:a});if(r)throw r;return s},{enabled:p,refetchOnWindowFocus:!1}),_=y?y.message:null;return!_&&(null==f?void 0:f.error)&&(_=null==f?void 0:f.error),i.pe&&(h&&(_={message:"The parser does not yet support WITH and subquery statements.",docs:"https://supabase.com/docs/guides/platform/advanced-log-filtering#the-with-keyword-and-subqueries-are-not-supported"}),g&&(_={message:"BigQuery does not support ILIKE. Use REGEXP_CONTAINS instead.",docs:"https://supabase.com/docs/guides/platform/advanced-log-filtering#the-ilike-and-similar-to-keywords-are-not-supported"})),{params:u,isLoading:p&&x||v,logData:null!=(t=null==f?void 0:f.result)?t:[],error:_,changeQuery:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";m(t=>({...t,sql:e}))},runQuery:()=>b(),setParams:m}}},19842:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ez});var s=a(80263),r=a(53239),i=a(60045),l=a(32144),n=a(53434),o=a.n(n),d=a(94786),c=a(73892),u=a(66452),m=a(63320),p=a.n(m),h=a(73969),g=a(16601),f=a(98883),y=a(89044),x=a(49089),v=a(80369),b=a(49018),_=a(7197),j=a(6408),A=a(45969),k=a(45259),C=a(33794),w=a(79319),N=a(52385),S=a(3732),I=a(72225),P=a(54045),E=a(85025),D=a(45571),T=a(11352),R=a(90235),M=a(2743),L=a(33887),q=a(55739);let z=e=>{var t,a,i,l;let{label:n,attribute:o,provider:d,startDate:c,endDate:u,interval:m,customDateFormat:p,children:h=null,defaultChartStyle:f="bar",hideChartType:y=!1,data:x,isLoading:v,format:b,highlightedValue:_}=e,{ref:j}=(0,N.useRouter)().query,A=(0,L.RE)(),[k,C]=(0,r.useState)(f),w=A.selectedDatabaseId,{data:z,isLoading:O}=(0,D.J)({projectRef:j,attribute:o,startDate:c,endDate:u,interval:m,databaseIdentifier:w},{enabled:"daily-stats"===d&&void 0===x}),{data:B,isLoading:H}=(0,E.q)({projectRef:j,attribute:o,startDate:c,endDate:u,interval:m,databaseIdentifier:w},{enabled:"infra-monitoring"===d&&void 0===x}),G=x||("infra-monitoring"===d?B:"daily-stats"===d?z:void 0),U="daily-stats"===d&&!o.includes("ingress")&&!o.includes("egress")&&void 0!==G&&"maximum"in G,F=void 0!==G&&"totalGrouped"in G,K=void 0!==_?_:U?null==G?void 0:G.maximum:"daily-stats"===d?null==G?void 0:G.total:F?null==G||null==(t=G.totalGrouped)?void 0:t[o]:null==G||null==(a=G.data[(null==G?void 0:G.data.length)-1])?void 0:a[o];return v||("infra-monitoring"===d?H:"daily-stats"===d?O:v)?(0,s.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,s.jsx)(T.A,{size:18,className:"animate-spin text-border-strong"}),(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Loading data for ",n]})]}):void 0===G?(0,s.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,s.jsx)(q.id,{}),(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Unable to load data for ",n]})]}):(0,s.jsxs)("div",{className:"h-full w-full","data-sentry-component":"ChartHandler","data-sentry-source-file":"ChartHandler.tsx",children:[(0,s.jsxs)("div",{className:"absolute right-6 z-10 flex justify-between",children:[!y&&(0,s.jsxs)(S.m_,{children:[(0,s.jsx)(S.k$,{asChild:!0,children:(0,s.jsx)(g.$,{type:"default",className:"px-1.5",icon:"bar"===k?(0,s.jsx)(R.A,{}):(0,s.jsx)(M.A,{}),onClick:()=>C("bar"===k?"line":"bar")})}),(0,s.jsxs)(S.ZI,{side:"left",align:"center",children:["View as ","bar"===k?"line chart":"bar chart"]})]}),h]}),"bar"===k?(0,s.jsx)(P.A,{YAxisProps:{width:1},data:null!=(i=null==G?void 0:G.data)?i:[],format:b||(null==G?void 0:G.format),xAxisKey:"period_start",yAxisKey:o,highlightedValue:K,title:n,customDateFormat:p}):(0,s.jsx)(I.A,{data:null!=(l=null==G?void 0:G.data)?l:[],format:b||(null==G?void 0:G.format),xAxisKey:"period_start",yAxisKey:o,highlightedValue:K,title:n,customDateFormat:p})]})};var O=a(41960),B=a(17457),H=a(2),G=a(796),U=a(32932),F=a(55433),K=a(42417),X=a(53190),V=a(37475),W=a(67435),Q=a(98140),Y=a(42631),$=a(24831),Z=a(83455),J=a(65842),ee=a(33656);let et=e=>{var t,a;let{chartHighlight:i,updateDateRange:l}=e,{left:n,right:d,clearHighlight:u}=null!=i?i:{},[m,p]=(0,r.useState)(!!(null==i?void 0:i.popoverPosition));(0,r.useEffect)(()=>{p(!!(null==i?void 0:i.popoverPosition)&&n!==d)},[null==i?void 0:i.popoverPosition]);let h=10>o()(d).diff(o()(n),"minutes");return(0,s.jsxs)(ee.rI,{open:m,onOpenChange:p,"data-sentry-element":"DropdownMenu","data-sentry-component":"ChartHighlightActions","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,s.jsx)(ee.ty,{className:"w-auto p-0",style:{position:"absolute",left:(null==i||null==(t=i.popoverPosition)?void 0:t.x)+"px",top:(null==i||null==(a=i.popoverPosition)?void 0:a.y)+"px"},"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,s.jsxs)(ee.SQ,{className:"flex flex-col gap-1 p-1 w-fit text-left","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,s.jsxs)(ee.lp,{className:"flex items-center justify-center text-foreground-lighter font-mono gap-1 text-xs","data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"ChartHighlightActions.tsx",children:[(0,s.jsx)("span",{children:o()(n).format("MMM D, H:mm")}),(0,s.jsx)(c.A,{size:10,"data-sentry-element":"ArrowRight","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,s.jsx)("span",{children:o()(d).format("MMM D, H:mm")})]}),(0,s.jsx)(ee.mB,{className:"my-0","data-sentry-element":"DropdownMenuSeparator","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,s.jsx)(ee._2,{disabled:h,className:(0,H.cn)("group",h&&"!bg-transparent"),"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"ChartHighlightActions.tsx",children:(0,s.jsxs)("button",{disabled:h,onClick:()=>{!h&&(l(n,d),u&&u())},className:"w-full flex items-center gap-1.5",children:[(0,s.jsx)(J.A,{className:"text-foreground-lighter",size:12,"data-sentry-element":"SearchIcon","data-sentry-source-file":"ChartHighlightActions.tsx"}),(0,s.jsx)("span",{className:"flex-grow text-left text-foreground-light",children:"Zoom in"}),h&&(0,s.jsx)("span",{className:"text-foreground-muted text-xs",children:"10 minutes min."})]})})]})]})};var ea=a(9603),es=a(84430);let er=e=>{let{color:t}=e;return(0,s.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-component":"CustomIcon","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,s.jsx)("circle",{cx:"5",cy:"5",r:"3",fill:t,"data-sentry-element":"circle","data-sentry-source-file":"ComposedChart.utils.tsx"})})},ei=()=>(0,s.jsx)("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-component":"MaxConnectionsIcon","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,s.jsx)("line",{x1:"2",y1:"6",x2:"12",y2:"6",stroke:"#3ECF8E",strokeWidth:"2",strokeDasharray:"2 2","data-sentry-element":"line","data-sentry-source-file":"ComposedChart.utils.tsx"})}),el=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,a)).toFixed(t)," ").concat(["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][a])},en=e=>null==e?void 0:e.find(e=>e.isMaxValue),eo=(e,t)=>null==e?void 0:e.filter(e=>!(null==t?void 0:t.includes(e.dataKey))).reduce((e,t)=>e+t.value,0),ed=e=>{let{active:t,payload:a,attributes:r,isPercentage:i,valuePrecision:l,showTotal:n}=e;if(t&&a&&a.length){let e=a[0].payload.timestamp,d=en(r),c=d&&(null==a?void 0:a.find(e=>e.dataKey===d.attribute)),u=null==c?void 0:c.value,m=null==a?void 0:a.some(e=>e.dataKey.toLowerCase().includes("ram_")),p=n&&eo(a,(null==d?void 0:d.attribute)?[d.attribute]:[]),h=(e,t)=>!1===e.toLowerCase().includes("max")?(0,s.jsx)(er,{color:t}):(0,s.jsx)(ei,{}),g=e=>{let{entry:t}=e,a=null==r?void 0:r.find(e=>e.attribute===t.name),n=(t.value/u*100).toFixed(1),o=t.dataKey===(null==d?void 0:d.attribute);return(0,s.jsxs)("div",{className:"flex items-center w-full","data-sentry-component":"LabelItem","data-sentry-source-file":"ComposedChart.utils.tsx",children:[h(t.name,t.color),(0,s.jsx)("span",{className:"text-foreground-lighter ml-1 flex-grow",children:(null==a?void 0:a.label)||t.name}),(0,s.jsxs)("span",{className:"ml-3.5 flex items-end gap-1",children:[m?el(t.value,l):(0,es.Eg)(t.value,l),i?"%":"",!!c&&!o&&(0,s.jsxs)("span",{className:"text-[11px] text-foreground-light mb-0.5",children:["(",n,"%)"]})]})]},t.name)};return(0,s.jsxs)("div",{className:"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg px-2.5 py-1.5 text-xs shadow-xl",children:[(0,s.jsx)("p",{className:"font-medium",children:o()(e).format(ea.C_.FULL_SECONDS)}),(0,s.jsxs)("div",{className:"grid gap-0",children:[a.reverse().map((e,t)=>(0,s.jsx)(g,{entry:e},"".concat(e.name,"-").concat(t))),t&&n&&(0,s.jsxs)("div",{className:"flex md:flex-col gap-1 md:gap-0 text-foreground font-semibold",children:[(0,s.jsx)("span",{className:"flex-grow text-foreground-lighter",children:"Total"}),(0,s.jsxs)("div",{className:"flex items-end gap-1",children:[(0,s.jsxs)("span",{className:"text-base",children:[m?el(p,1):(0,es.Eg)(p),i?"%":""]}),d&&!isNaN(p/(null==c?void 0:c.value))&&isFinite(p/(null==c?void 0:c.value))&&(0,s.jsxs)("span",{className:"text-[11px] text-foreground-light mb-0.5",children:["(",(p/(null==c?void 0:c.value)*100).toFixed(1),"%)"]})]})]})]})]})}return null},ec=e=>{let{payload:t,attributes:a,showMaxValue:i,onLabelHover:l}=e,n=null!=t?t:[],o=en(a),[d,c]=(0,r.useState)(null),u=e=>{c(e),null==l||l(e)},m=()=>{c(null),null==l||l(null)},p=(e,t)=>e===(null==o?void 0:o.attribute)==!0?(0,s.jsx)(ei,{}):(0,s.jsx)(er,{color:t}),h=e=>{let{entry:t}=e,r=null==a?void 0:a.find(e=>e.attribute===t.name),l=t.name===(null==o?void 0:o.attribute),n=d===t.name,c=()=>(0,s.jsxs)("div",{className:"flex items-center gap-1","data-sentry-component":"Label","data-sentry-source-file":"ComposedChart.utils.tsx",children:[p(t.name,t.color),(0,s.jsx)("span",{className:(0,H.cn)("text-nowrap text-foreground-lighter pr-2",d&&!n&&"opacity-50"),children:(null==r?void 0:r.label)||t.name})]});return!i&&l?null:(0,s.jsx)("div",{className:"inline-flex md:flex-col gap-1 md:gap-0 w-fit text-foreground",onMouseEnter:()=>u(t.name),onMouseOutCapture:m,"data-sentry-component":"LabelItem","data-sentry-source-file":"ComposedChart.utils.tsx",children:(null==r?void 0:r.tooltip)?(0,s.jsxs)(S.m_,{children:[(0,s.jsx)(S.k$,{children:(0,s.jsx)(c,{})}),(0,s.jsx)(S.ZI,{side:"bottom",align:"center",className:"max-w-[250px]",children:r.tooltip})]}):(0,s.jsx)(c,{})},t.name)};return(0,s.jsx)("div",{className:"relative z-0 mx-auto flex flex-col items-center gap-1 text-xs w-full","data-sentry-component":"CustomLabel","data-sentry-source-file":"ComposedChart.utils.tsx",children:(0,s.jsx)("div",{className:"flex flex-wrap items-center justify-center gap-2",children:null==n?void 0:n.map((e,t)=>(0,s.jsx)(h,{entry:e},"".concat(e.name,"-").concat(t)))})})};var eu=a(45168);function em(e){var t,a,i,l,n,d;let{data:c,attributes:u,yAxisKey:m,xAxisKey:p,format:h,customDateFormat:g=ea.C_.FULL,title:f,highlightedValue:y,highlightedLabel:x,displayDateInUtc:v,minimalHeader:b,valuePrecision:_,className:j="",size:A="normal",emptyStateMessage:k,onBarClick:C,showLegend:w=!1,xAxisIsDate:N=!0,XAxisProps:S,YAxisProps:I,showGrid:P=!1,showTooltip:E=!1,showTotal:D=!0,showMaxValue:T=!1,chartHighlight:R,hideChartType:M,chartStyle:L,onChartStyleChange:q,updateDateRange:z}=e,{resolvedTheme:O}=(0,G.D)(),[B,J]=(0,r.useState)(null),[ee,er]=(0,r.useState)(T),[ei,en]=(0,r.useState)(null),[em,ep]=(0,r.useState)(null);(0,r.useEffect)(()=>{var e;(0,ea.fE)(null!=(e=null==O?void 0:O.includes("dark"))&&e)},[O]);let{Container:eh}=(0,es.dQ)(A),eg=S||{interval:c.length-2,angle:0,tick:!1},ef=I||{tickFormatter:e=>(0,es.Eg)(e,_),tick:!1,width:0},ey=e=>v?o()(e).utc():o()(e),ex=u.find(e=>e.isMaxValue),ev={name:null==ex?void 0:ex.attribute,color:"#3ECF8E"},eb=c[c.length-1]?Object.entries(c[c.length-1]).map(e=>{let[t,a]=e;return{dataKey:t,value:a}}).filter(e=>"timestamp"!==e.dataKey):void 0,e_=function(){if(!N){var e;return ei?null==(e=c[ei])?void 0:e.timestamp:x}return null!==ei&&c&&void 0!==c[ei]&&ey(c[ei].timestamp).format(g)||x}(),ej=null!==ei?D?eo(B,(null==ex?void 0:ex.attribute)?[null==ex?void 0:ex.attribute]:[]):null==(t=c[ei])?void 0:t[m]:D&&eb?eo(eb,(null==ex?void 0:ex.attribute)?[null==ex?void 0:ex.attribute]:[]):y,eA=(null==R?void 0:R.coordinates.left)&&(null==R?void 0:R.coordinates.right)&&(null==R?void 0:R.coordinates.left)!==(null==R?void 0:R.coordinates.right),ek=c&&c[0]?null==(a=Object.entries(c[0]))?void 0:a.map((e,t)=>{let[a,s]=e;return{name:a,value:s,color:ea.E6[t-1%ea.E6.length]}}).filter(e=>"timestamp"!==e.name&&e.name!==(null==ex?void 0:ex.attribute)):[],eC=ek.filter(e=>!e.name.includes("max")),ew="%"===h,eN=null==ek?void 0:ek.some(e=>e.name.toLowerCase().includes("ram_")),eS=[0,Math.max(...ek.map(e=>"number"==typeof e.value?e.value:0))];return 0===c.length?(0,s.jsx)(eu.A,{message:k,description:"It may take up to 24 hours for data to refresh",size:A,className:j,attribute:f,format:h}):(0,s.jsxs)("div",{className:(0,H.cn)("flex flex-col gap-y-3",j),"data-sentry-component":"ComposedChart","data-sentry-source-file":"ComposedChart.tsx",children:[(0,s.jsx)(Z.A,{title:f,format:h,customDateFormat:g,highlightedValue:"number"==typeof ej?eN?el(ej,_):(0,es.Eg)(ej,_):ej,highlightedLabel:e_,minimalHeader:b,hideChartType:M,chartStyle:L,onChartStyleChange:q,showMaxValue:ee,setShowMaxValue:ex?er:void 0,"data-sentry-element":"ChartHeader","data-sentry-source-file":"ComposedChart.tsx"}),(0,s.jsxs)(eh,{className:"relative z-10","data-sentry-element":"Container","data-sentry-source-file":"ComposedChart.tsx",children:[(0,s.jsxs)(U.X,{data:c,onMouseMove:e=>{var t;e.activeTooltipIndex!==ei&&(en(e.activeTooltipIndex),J(e.activePayload));let a=null==(t=c[e.activeTooltipIndex])?void 0:t.timestamp;null==R||R.handleMouseMove({activeLabel:null==a?void 0:a.toString(),coordinates:e.activeLabel})},onMouseDown:e=>{var t;let a=null==(t=c[e.activeTooltipIndex])?void 0:t.timestamp;null==R||R.handleMouseDown({activeLabel:null==a?void 0:a.toString(),coordinates:e.activeLabel})},onMouseUp:null==R?void 0:R.handleMouseUp,onMouseLeave:e=>{en(null),J(null)},onClick:e=>{var t,a;let s=null==e||null==(a=e.activePayload)||null==(t=a[0])?void 0:t.payload;C&&C(s,e)},"data-sentry-element":"RechartComposedChart","data-sentry-source-file":"ComposedChart.tsx",children:[P&&(0,s.jsx)(F.d,{stroke:ea.OK.AXIS}),(0,r.createElement)(K.h,{...ef,hide:!0,domain:ew?eS:void 0,key:m,"data-sentry-element":"YAxis","data-sentry-source-file":"ComposedChart.tsx"}),(0,r.createElement)(X.W,{...eg,axisLine:{stroke:ea.OK.AXIS},tickLine:{stroke:ea.OK.AXIS},tickMargin:8,minTickGap:3,key:p,"data-sentry-element":"XAxis","data-sentry-source-file":"ComposedChart.tsx"}),(0,s.jsx)(V.m,{content:e=>E?(0,s.jsx)(ed,{...e,isPercentage:ew,label:e_,attributes:u,valuePrecision:_,showTotal:D}):null,"data-sentry-element":"Tooltip","data-sentry-source-file":"ComposedChart.tsx"}),"bar"===L?eC.map(e=>{var t;return(0,s.jsx)(W.y,{dataKey:e.name,stackId:"1",fill:e.color,fillOpacity:em&&em!==e.name?.25:1,radius:.75,opacity:em&&em!==e.name?.5:1,name:(null==u||null==(t=u.find(t=>t.attribute===e.name))?void 0:t.label)||e.name},e.name)}):eC.map(e=>{var t;return(0,s.jsx)(Q.G,{type:"step",dataKey:e.name,stackId:"1",fill:e.color,strokeOpacity:em&&em!==e.name?.4:1,stroke:e.color,radius:20,animationDuration:375,fillOpacity:em&&em!==e.name?.075:em===e.name?.3:.25,name:(null==u||null==(t=u.find(t=>t.attribute===e.name))?void 0:t.label)||e.name},e.name)}),ex&&ee&&(0,s.jsx)(Y.N,{type:"stepAfter",dataKey:ex.attribute,stroke:"#3ECF8E",strokeWidth:2,strokeDasharray:"3 3",dot:!1,name:ex.label},ex.attribute),eA&&(0,s.jsx)($.T,{x1:null==R?void 0:R.coordinates.left,x2:null==R?void 0:R.coordinates.right,strokeOpacity:.5,stroke:"#3ECF8E",fill:"#3ECF8E",fillOpacity:.3})]}),(0,s.jsx)(et,{chartHighlight:R,updateDateRange:z,"data-sentry-element":"ChartHighlightActions","data-sentry-source-file":"ComposedChart.tsx"})]}),c&&(0,s.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{children:N?ey(null==(i=c[0])?void 0:i.timestamp).format(g):null==(l=c[0])?void 0:l.timestamp}),(0,s.jsx)("span",{children:N?ey(null==(n=c[(null==c?void 0:c.length)-1])?void 0:n.timestamp).format(g):null==(d=c[(null==c?void 0:c.length)-1])?void 0:d.timestamp})]}),w&&(0,s.jsx)(ec,{payload:[ev,...ek],attributes:u,showMaxValue:ee,onLabelHover:ep})]})}let ep=e=>{let{children:t}=e,[a,i]=(0,r.useState)(!1),l=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=new IntersectionObserver(t=>{let[a]=t;a.isIntersecting&&(i(!0),e.disconnect())},{rootMargin:"150px 0px",threshold:0}),t=l.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[]),(0,s.jsx)("div",{ref:l,"data-sentry-component":"LazyChartWrapper","data-sentry-source-file":"ComposedChartHandler.tsx",children:r.cloneElement(t,{isVisible:a})})},eh=e=>{let{label:t,attributes:a,startDate:i,endDate:l,interval:n,customDateFormat:d,children:c=null,defaultChartStyle:u="bar",hideChartType:m=!1,data:p,isLoading:h,format:g,highlightedValue:f,className:y,showTooltip:x,showLegend:v,showMaxValue:b,showTotal:_,updateDateRange:j,valuePrecision:A,isVisible:k=!0}=e,{ref:C}=(0,N.useRouter)().query,w=(0,L.RE)(),[S,I]=(0,r.useState)(u),P=function(){let[e,t]=(0,r.useState)(void 0),[a,s]=(0,r.useState)(void 0),[i,l]=(0,r.useState)({left:void 0,right:void 0}),[n,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[m,p]=(0,r.useState)(void 0),h=()=>{t(void 0),s(void 0),l({left:void 0,right:void 0}),u(null),p(void 0)};return{left:e,right:a,coordinates:i,isSelecting:n,popoverPosition:c,handleMouseDown:e=>{h(),e&&e.activeLabel&&(d(!0),t(e.activeLabel),s(e.activeLabel),p(e.activeLabel),l({left:e.coordinates,right:e.coordinates}))},handleMouseMove:e=>{if(!n||!e||!e.activeLabel)return;let a=o()(e.activeLabel),r=o()(m);a.isBefore(r)?(t(e.activeLabel),s(m),l({left:e.coordinates,right:i.right})):(s(e.activeLabel),t(m),l({left:i.left,right:e.coordinates}))},handleMouseUp:e=>{n&&(d(!1),u({x:e.chartX,y:e.chartY}),p(void 0))},clearHighlight:h}}(),E=eg(a,C,i,l,n,w.selectedDatabaseId,p,k),D=(0,r.useMemo)(()=>{if(p)return p;if(E.some(e=>e.isLoading)||E.some(e=>!e.data))return;let e=new Set;return E.forEach(t=>{var a,s;null==(s=t.data)||null==(a=s.data)||a.forEach(t=>{e.add(t.period_start)})}),Array.from(e).sort().map(e=>{let t={timestamp:e};return a.forEach((a,s)=>{var r,i;let l=null==(r=E[s].data)?void 0:r.data,n=null==l?void 0:l.find(t=>t.period_start===e);t[a.attribute]=null!=(i=null==n?void 0:n[a.attribute])?i:0}),t})},[p,E,a]),R=h||E.some(e=>e.isLoading),M=(0,r.useMemo)(()=>{var e,t;if(void 0!==f)return f;let s=a[0],r=E[0],i=null==r?void 0:r.data;if(!i)return;let l="daily-stats"===s.provider&&!s.attribute.includes("ingress")&&!s.attribute.includes("egress")&&"maximum"in i,n="totalGrouped"in i;return l?i.maximum:"daily-stats"===s.provider?i.total:n?null==(e=i.totalGrouped)?void 0:e[s.attribute]:null==(t=i.data[i.data.length-1])?void 0:t[s.attribute]},[f,a,E]);return R?(0,s.jsxs)(O.A,{className:(0,H.cn)("flex min-h-[320px] w-full flex-col items-center justify-center gap-y-2",y),wrapWithLoading:!1,noMargin:!0,noHideOverflow:!0,children:[(0,s.jsx)(T.A,{size:18,className:"animate-spin text-border-strong"}),(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Loading data for ",t]})]}):D?(0,s.jsx)(O.A,{noMargin:!0,noHideOverflow:!0,className:(0,H.cn)("relative py-2 w-full",y),wrapWithLoading:!1,"data-sentry-element":"Panel","data-sentry-component":"ComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx",children:(0,s.jsxs)(O.A.Content,{className:"flex flex-col gap-4","data-sentry-element":"unknown","data-sentry-source-file":"ComposedChartHandler.tsx",children:[(0,s.jsx)("div",{className:"absolute right-6 z-50 flex justify-between scroll-mt-10",id:t.toLowerCase().replaceAll(" ","-"),children:c}),(0,s.jsx)(em,{attributes:a,YAxisProps:{width:1},data:D,format:g,xAxisKey:"period_start",yAxisKey:a[0].attribute,highlightedValue:M,title:t,customDateFormat:d,chartHighlight:P,chartStyle:S,showTooltip:x,showLegend:v,showTotal:_,showMaxValue:b,onChartStyleChange:I,updateDateRange:j,valuePrecision:A,hideChartType:m,"data-sentry-element":"ComposedChart","data-sentry-source-file":"ComposedChartHandler.tsx"})]})}):(0,s.jsxs)("div",{className:"flex h-52 w-full flex-col items-center justify-center gap-y-2",children:[(0,s.jsx)(q.id,{}),(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Unable to load data for ",t]})]})},eg=(e,t,a,s,r,i,l,n)=>{let o=e.filter(e=>"infra-monitoring"===e.provider).map(e=>e.attribute),d=e.filter(e=>"daily-stats"===e.provider).map(e=>e.attribute);return[...o.map(e=>(0,E.q)({projectRef:t,attribute:e,startDate:a,endDate:s,interval:r,databaseIdentifier:i},{enabled:void 0===l&&n})),...d.map(e=>(0,D.J)({projectRef:t,attribute:e,startDate:a,endDate:s,interval:r,databaseIdentifier:i},{enabled:void 0===l&&n}))]};function ef(e){return(0,s.jsx)(ep,{"data-sentry-element":"LazyChartWrapper","data-sentry-component":"LazyComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx",children:(0,s.jsx)(eh,{...e,"data-sentry-element":"ComposedChartHandler","data-sentry-source-file":"ComposedChartHandler.tsx"})})}var ey=a(955),ex=a(91846),ev=a(36567),eb=a(25718),e_=a(58897);let ej=e=>{let{className:t}=e,{ref:a}=(0,y.g)(),r=(0,eb.a)(),{mutate:i}=(0,ev.h)();return(0,s.jsxs)("div",{className:(0,H.cn)("flex gap-2",t),"data-sentry-component":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,s.jsx)(g.$,{type:"outline",className:"bg-alternative",size:"tiny",icon:(0,s.jsx)(ex.A,{}),asChild:!0,"data-sentry-element":"Button","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,s.jsx)(p(),{href:"https://supabase.com/docs/guides/telemetry/metrics",target:"_blank",onClick:()=>{var e;return i({action:"reports_database_grafana_banner_clicked",groups:{project:null!=a?a:"Unknown",organization:null!=(e=null==r?void 0:r.slug)?e:"Unknown"}})},"data-sentry-element":"Link","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Docs"})}),(0,s.jsx)(g.$,{type:"default",size:"tiny",asChild:!0,"data-sentry-element":"Button","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,s.jsx)(p(),{href:"https://github.com/supabase/supabase-grafana",target:"_blank",onClick:()=>{var e;return i({action:"reports_database_grafana_banner_clicked",groups:{project:null!=a?a:"Unknown",organization:null!=(e=null==r?void 0:r.slug)?e:"Unknown"}})},"data-sentry-element":"Link","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Configure Grafana"})})]})},eA=()=>(0,s.jsxs)(f.Fc,{className:"relative overflow-hidden","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"GrafanaPromoBanner","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,s.jsxs)("div",{className:"absolute inset-0 z-0",children:[(0,s.jsx)("img",{src:"".concat(e_.o2,"/img/reports/bg-grafana-dark.svg"),alt:"Supabase Grafana",className:"w-full h-full object-cover object-right hidden dark:block"}),(0,s.jsx)("img",{src:"".concat(e_.o2,"/img/reports/bg-grafana-light.svg"),alt:"Supabase Grafana",className:"w-full h-full object-cover object-right dark:hidden"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-background-alternative to-transparent"})]}),(0,s.jsx)("svg",{width:"78",height:"86",viewBox:"0 0 78 86",className:"w-4 h-4",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:(0,s.jsx)("path",{d:"M77.777 38.148c-.15-1.344-.299-2.987-.896-4.778-.448-1.792-1.194-3.733-2.24-5.823-1.045-2.09-2.388-4.18-4.03-6.27-.598-.747-1.344-1.643-2.24-2.39 1.194-4.777-1.493-8.808-1.493-8.808-4.48-.299-7.465 1.343-8.51 2.24-.15 0-.3-.15-.598-.3a41.262 41.262 0 0 0-2.388-.895c-.896-.299-1.643-.448-2.538-.747-.896-.15-1.792-.298-2.539-.448h-.448C47.917 3.66 42.243.971 42.243.971c-6.27 4.031-7.465 9.556-7.465 9.556v.298c-.299.15-.747.15-1.045.299-.448.15-.896.298-1.493.448-.448.149-.896.298-1.493.597-.896.448-1.941.896-2.837 1.344-.896.447-1.792 1.045-2.688 1.642-.149 0-.149-.15-.149-.15-8.809-3.284-16.572.747-16.572.747-.747 9.257 3.434 15.229 4.33 16.274-.15.597-.448 1.194-.598 1.792-.597 2.09-1.194 4.33-1.493 6.57 0 .298-.15.596-.15.895C2.529 45.314.14 53.526.14 53.526c6.718 7.763 14.631 8.211 14.631 8.211 1.045 1.792 2.09 3.434 3.434 5.077.597.597 1.195 1.343 1.643 1.94-2.39 7.018.298 12.84.298 12.84 7.465.3 12.392-3.284 13.437-4.18.747.299 1.493.448 2.24.747 2.24.597 4.628.895 7.017 1.045h2.837c3.583 5.076 9.705 5.822 9.705 5.822 4.479-4.628 4.628-9.256 4.628-10.302v-.299c.896-.596 1.791-1.343 2.688-2.09 1.791-1.642 3.284-3.433 4.628-5.374.15-.15.298-.299.298-.597 5.077.298 8.51-3.136 8.51-3.136-.895-5.225-3.882-7.763-4.479-8.211h-.149V48.748c-.15-.597-.15-1.194-.298-1.642-.597-2.24-1.344-4.33-2.538-6.271-1.195-1.941-2.539-3.583-4.181-5.076-1.642-1.493-3.434-2.538-5.375-3.434-1.94-.896-3.882-1.344-5.972-1.643-1.045-.149-1.94-.149-2.986-.149H48.663c-.448 0-1.045.15-1.493.15a14.617 14.617 0 0 0-5.524 2.09c-1.643 1.045-3.136 2.24-4.33 3.583-1.195 1.344-2.09 2.986-2.688 4.628-.597 1.643-.895 3.285-1.045 4.927V48.3c.15.746.299 1.643.448 2.389.448 1.493 1.195 2.837 1.941 4.03.896 1.196 1.941 2.091 2.986 2.838 1.045.746 2.24 1.343 3.434 1.642 1.195.299 2.24.448 3.434.448H47.767c.15 0 .299 0 .448-.15.298 0 .448-.148.747-.148.448-.15.895-.3 1.343-.598.448-.15.747-.448 1.195-.746.149 0 .15-.15.298-.299.448-.299.448-.896.15-1.194-.299-.299-.747-.448-1.045-.15-.15 0-.15.15-.299.15-.299.149-.597.298-1.045.447-.299.15-.747.15-1.045.299h-2.389c-.896-.15-1.643-.299-2.538-.746-.896-.299-1.643-.896-2.39-1.493-.746-.598-1.343-1.493-1.79-2.24-.448-.746-.897-1.792-1.046-2.836-.15-.448-.15-1.046-.15-1.494v-.746c0-.299 0-.598.15-.896a11.78 11.78 0 0 1 3.285-6.121c.448-.448.895-.747 1.343-1.195.448-.298 1.046-.597 1.493-.896.598-.298 1.195-.447 1.643-.597.597-.15 1.194-.298 1.791-.298h1.792c.597 0 1.344.149 1.94.298 1.345.299 2.539.747 3.734 1.493 2.388 1.344 4.33 3.434 5.673 5.823.597 1.194 1.045 2.538 1.344 3.882 0 .299.149.747.149 1.045V52.63c0 .448 0 .746-.15 1.194 0 .299-.149.747-.149 1.045 0 .299-.149.747-.298 1.046-.15.746-.448 1.492-.747 2.09a27.148 27.148 0 0 1-2.24 4.03c-1.79 2.39-4.18 4.48-7.016 5.674-1.344.598-2.837 1.045-4.33 1.344-.747.15-1.493.15-2.24.299H43.14c-1.642-.15-3.285-.448-4.778-.896-1.493-.448-3.135-1.045-4.479-1.792-2.837-1.493-5.375-3.583-7.465-6.121-1.045-1.194-1.941-2.538-2.538-4.031a28.024 28.024 0 0 1-1.792-4.48c-.448-1.492-.746-3.135-.746-4.628V44.567c0-.746.149-1.642.149-2.388.15-.747.299-1.643.448-2.389.15-.747.298-1.642.597-2.389.448-1.493 1.045-2.986 1.642-4.48 1.344-2.836 2.986-5.374 5.077-7.315.447-.448 1.045-1.045 1.642-1.493.597-.448 1.194-.896 1.792-1.194.597-.448 1.194-.747 1.791-1.046l.896-.447c.15 0 .299-.15.448-.15.15 0 .298-.149.448-.149.597-.299 1.344-.448 1.94-.746.15 0 .3-.15.449-.15.149 0 .299-.15.448-.15.298-.148.746-.148 1.045-.298.149 0 .298-.149.597-.149.15 0 .298 0 .597-.15.15 0 .299 0 .597-.149h.597c.15 0 .299 0 .598-.149.15 0 .448 0 .597-.15h5.225c1.344 0 2.688.15 4.032.449 2.538.448 4.927 1.343 7.166 2.389a23.309 23.309 0 0 1 5.823 3.881l.299.299.298.299c.15.149.448.298.597.597.15.298.448.298.598.597.149.299.448.448.597.597a15.109 15.109 0 0 1 1.94 2.39c1.195 1.492 2.24 3.134 2.987 4.627 0 .15.15.15.15.3 0 .148.148.148.148.298.15.149.15.298.299.597.15.15.15.298.299.597.149.15.149.299.298.597.3.747.598 1.344.747 1.941.298 1.045.597 1.941.746 2.688.15.298.448.597.747.448.298 0 .597-.299.597-.598.597-1.791.597-2.837.448-3.882Z",fill:"currentColor","data-sentry-element":"path","data-sentry-source-file":"GrafanaPromoBanner.tsx"})}),(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 mt-1",children:[(0,s.jsx)(f.XL,{className:"flex-grow","data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:"Advanced observability"}),(0,s.jsx)(ej,{className:"hidden xl:flex","data-sentry-element":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx"})]}),(0,s.jsxs)(f.TN,{className:"relative flex flex-col xl:flex-row gap-2 md:max-w-lg","data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"GrafanaPromoBanner.tsx",children:[(0,s.jsx)("p",{className:"flex-grow",children:"Set up the Supabase Grafana Dashboard to visualize over 200 database performance and health metrics on your Supabase project."}),(0,s.jsx)(ej,{className:"xl:hidden","data-sentry-element":"GrafanaBannerActions","data-sentry-source-file":"GrafanaPromoBanner.tsx"})]})]});var ek=a(55319);let eC=e=>[{id:"ram_usage",label:"Memory usage",hide:!1},{id:"avg_cpu_usage",label:"Average CPU usage",hide:!1},{id:"max_cpu_usage",label:"Max CPU usage",hide:!1},{id:"disk_iops_write",label:"Disk IOps write",hide:!1},{id:"disk_iops_read",label:"Disk IOps read",hide:!1},{id:"pg_stat_database_num_backends",label:"Pooler to database connections",hide:!1},{id:"supavisor_connections_active",label:"Client to Shared Pooler connections",hide:!1},{id:"client_connections_pgbouncer",label:"Client to Dedicated Pooler connections",hide:e}],ew=e=>[{id:"ram-usage",label:"Memory usage",hide:!1,showTooltip:!0,showLegend:!0,hideChartType:!1,defaultChartStyle:"line",showMaxValue:!1,attributes:[{attribute:"ram_usage_used",provider:"infra-monitoring",label:"Used",tooltip:"Total RAM currently in use by the system and applications. High usage may indicate memory pressure."},{attribute:"ram_usage_cache_and_buffers",provider:"infra-monitoring",label:"Cache + buffers",tooltip:"RAM used for caching and buffering disk operations. Higher values improve read performance."},{attribute:"ram_usage_free",provider:"infra-monitoring",label:"Free",tooltip:"Available unused RAM. A small amount is always reserved. High unused RAM present with erratic Used RAM may indicate unoptimized queries disrupting cache."},{attribute:"ram_usage_swap",provider:"infra-monitoring",label:"Swap",tooltip:"Memory swapped to disk when RAM is full. An instance has 1GB of SWAP. High swap with high disk I/O signals memory stress."}]},{id:"cpu-usage",label:"CPU usage",format:"%",valuePrecision:2,hide:!1,showTooltip:!0,showLegend:!0,showMaxValue:!1,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"cpu_usage_busy_system",provider:"infra-monitoring",label:"System",format:"%",tooltip:"CPU time spent on kernel operations (e.g., process scheduling, memory management). High values may indicate system overhead."},{attribute:"cpu_usage_busy_user",provider:"infra-monitoring",label:"User",format:"%",tooltip:"CPU time used by database queries and user-space processes. High values may suggest CPU-intensive queries."},{attribute:"cpu_usage_busy_iowait",provider:"infra-monitoring",label:"IOwait",format:"%",tooltip:"CPU time waiting for disk or network I/O. High values may indicate disk bottlenecks."},{attribute:"cpu_usage_busy_irqs",provider:"infra-monitoring",label:"IRQs",format:"%",tooltip:"CPU time handling hardware interrupt requests (IRQ)"},{attribute:"cpu_usage_busy_other",provider:"infra-monitoring",label:"Other",format:"%",tooltip:"CPU time spent on other tasks (e.g., background processes, software interrupts)."}]},{id:"disk-iops",label:"Disk IOps",hide:!1,showTooltip:!0,showLegend:!0,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"disk_iops_write",provider:"infra-monitoring",label:"IOps write/s",tooltip:"Number of write operations per second. High values indicate frequent data writes, logging, or transaction activity."},{attribute:"disk_iops_read",provider:"infra-monitoring",label:"IOps read/s",tooltip:"Number of read operations per second. High values suggest frequent disk reads due to queries or poor caching."}]},{id:"client-connections",label:"Database client connections",valuePrecision:0,hide:!1,showTooltip:!1,showLegend:!1,showMaxValue:!1,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"pg_stat_database_num_backends",provider:"infra-monitoring",label:"active connections",tooltip:"Active connections"}]},{id:"pgbouncer-connections",label:"Pooler client connections",valuePrecision:0,hide:!1,showTooltip:!1,showLegend:!1,showMaxValue:!1,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"client_connections_pgbouncer",provider:"infra-monitoring",label:"pgbouncer",tooltip:"PgBouncer connections"}]},{id:"supavisor-connections-active",label:"Supavisor client connections",valuePrecision:0,hide:e,showTooltip:!1,showLegend:!1,showMaxValue:!1,hideChartType:!1,defaultChartStyle:"line",attributes:[{attribute:"supavisor_connections_active",provider:"infra-monitoring",label:"supavisor",tooltip:"Supavisor connections"}]}];var eN=a(91128),eS=a(32933),eI=a(84876);let eP=()=>{let{ref:e}=(0,y.g)(),t=(0,eI.B)(eS.NY.database.queries,null!=e?e:"default").largeObjects(),a=[t].some(e=>e.isLoading);return{data:{largeObjects:t.data},errors:{largeObjects:t.error},params:{largeObjects:t.params},largeObjectsSql:t.resolvedSql,isLoading:a,refresh:()=>t.runQuery}};var eE=a(72821),eD=a(65904),eT=a(31870),eR=a(24726),eM=a(60555),eL=a(90206);let eq=()=>(0,s.jsx)(v.A,{"data-sentry-element":"ReportPadding","data-sentry-component":"DatabaseReport","data-sentry-source-file":"database.tsx",children:(0,s.jsx)(eO,{"data-sentry-element":"DatabaseUsage","data-sentry-source-file":"database.tsx"})});eq.getLayout=e=>(0,s.jsx)(j.A,{children:(0,s.jsx)(k.A,{title:"Database",children:e})});let ez=eq,eO=()=>{var e,t,a;let{db:n,chart:m,ref:v}=(0,y.g)(),{project:j}=(0,A.Om)(),k=(0,eR._)("reportsDatabaseV2"),N=(0,L.RE)(),S=o()().subtract(7,"day").toISOString(),I=o()().toISOString(),[P,E]=(0,r.useState)({period_start:{date:S,time_period:"7d"},period_end:{date:I,time_period:"today"},interval:"1h"}),D=(0,l.jE)(),[T,R]=(0,r.useState)(!1),M=N.selectedDatabaseId!==(null==j?void 0:j.ref),q=eP(),{data:H,params:G,largeObjectsSql:U,isLoading:F,refresh:K}=q,{data:X}=(0,eN.Gw)({projectRef:null==j?void 0:j.ref,connectionString:null==j?void 0:j.connectionString}),V=null!=X?X:0,W=null!=(a=null==j?void 0:j.volumeSizeGb)?a:0,[Q,Y]=(0,r.useState)(!1),$=(0,eD.SE)(i.aG.UPDATE,"projects",{resource:{project_id:null==j?void 0:j.id}}),{plan:Z,isLoading:J}=(0,eT.c)(),ee=!J&&(null==Z?void 0:Z.id)==="free",et=eC(ee),ea=ew(ee),{isLoading:es}=(0,eE.F)({onSuccess:(e,t)=>{h.oR.success("Successfully updated disk size to ".concat(t.volumeSize," GB")),Y(!1)}}),er=async()=>{if(!P)return;R(!0),K();let{period_start:e,interval:t}=P;et.forEach(a=>{D.invalidateQueries(ek.P.infraMonitoring(v,{attribute:null==a?void 0:a.id,startDate:e.date,endDate:e.end,interval:t,databaseIdentifier:N.selectedDatabaseId}))}),M&&D.invalidateQueries(ek.P.infraMonitoring(v,{attribute:"physical_replication_lag_physical_replica_lag_seconds",startDate:e.date,endDate:e.end,interval:t,databaseIdentifier:N.selectedDatabaseId})),setTimeout(()=>R(!1),1e3)};(0,r.useEffect)(()=>{void 0!==n&&setTimeout(()=>{N.setSelectedDatabaseId(n)},100),void 0!==m&&setTimeout(()=>{let e=document.getElementById(m);e&&e.scrollIntoView({behavior:"smooth",block:"center"})},200)},[n,m]);let ei=(e,t)=>{let a={"1m":3>o()(t).diff(e,"hour"),"10m":6>o()(t).diff(e,"hour"),"30m":18>o()(t).diff(e,"hour"),"1h":10>o()(t).diff(e,"day"),"1d":o()(t).diff(e,"day")>=10};switch(!0){case a["1m"]:return"1m";case a["10m"]:return"10m";case a["30m"]:return"30m";default:return"1h"}},el=(e,t)=>{E({period_start:{date:e,time_period:"7d"},period_end:{date:t,time_period:"today"},interval:ei(e,t)})};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.A,{showDatabaseSelector:!0,title:"Database","data-sentry-element":"ReportHeader","data-sentry-source-file":"database.tsx"}),(0,s.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,s.jsx)("div",{className:"h-2 w-full",children:(0,s.jsx)(B.A,{active:q.isLoading,"data-sentry-element":"ShimmerLine","data-sentry-source-file":"database.tsx"})})}),(0,s.jsx)(eA,{"data-sentry-element":"GrafanaPromoBanner","data-sentry-source-file":"database.tsx"}),(0,s.jsxs)("section",{className:"relative pt-16 -mt-2",children:[(0,s.jsx)("div",{className:"absolute inset-0 z-40 pointer-events-none flex flex-col gap-4",children:(0,s.jsxs)("div",{className:"sticky top-0 bg-200 py-4 mb-4 flex items-center space-x-3 pointer-events-auto",children:[(0,s.jsx)(w.G,{type:"default",disabled:T,icon:(0,s.jsx)(d.A,{className:T?"animate-spin":""}),className:"w-7",tooltip:{content:{side:"bottom",text:"Refresh report"}},onClick:er,"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"database.tsx"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(ey.U,{loading:!1,value:"7d",options:eM.QP,currentBillingPeriodStart:void 0,onChange:e=>{"1d"===e.interval?E({...e,interval:"1h"}):E(e)},"data-sentry-element":"DateRangePicker","data-sentry-source-file":"database.tsx"}),P&&(0,s.jsxs)("div",{className:"flex items-center gap-x-2 text-xs",children:[(0,s.jsx)("p",{className:"text-foreground-light",children:o()(P.period_start.date).format("MMM D, h:mma")}),(0,s.jsx)("p",{className:"text-foreground-light",children:(0,s.jsx)(c.A,{size:12})}),(0,s.jsx)("p",{className:"text-foreground-light",children:o()(P.period_end.date).format("MMM D, h:mma")})]})]})]})}),k?(0,s.jsx)("div",{className:"grid grid-cols-1 gap-4",children:P&&ea.filter(e=>!e.hide).map(e=>{var t,a;return(0,s.jsx)(ef,{...e,attributes:e.attributes,interval:P.interval,startDate:null==P||null==(t=P.period_start)?void 0:t.date,endDate:null==P||null==(a=P.period_end)?void 0:a.date,updateDateRange:el,defaultChartStyle:e.defaultChartStyle},e.id)})}):(0,s.jsx)(O.A,{title:(0,s.jsx)("h2",{children:"Database health"}),children:(0,s.jsx)(O.A.Content,{className:"grid grid-cols-1 gap-4",children:P&&et.filter(e=>!e.hide).map(e=>{var t,a;return(0,s.jsx)(z,{provider:"infra-monitoring",attribute:e.id,label:e.label,interval:P.interval,startDate:null==P||null==(t=P.period_start)?void 0:t.date,endDate:null==P||null==(a=P.period_end)?void 0:a.date},e.id)})})}),P&&M&&(0,s.jsx)(O.A,{title:"Replica Information",children:(0,s.jsx)(O.A.Content,{children:(0,s.jsx)("div",{id:"replication-lag",children:(0,s.jsx)(z,{startDate:null==P||null==(e=P.period_start)?void 0:e.date,endDate:null==P||null==(t=P.period_end)?void 0:t.date,attribute:"physical_replication_lag_physical_replica_lag_seconds",label:"Replication lag",interval:P.interval,provider:"infra-monitoring"})})})})]}),(0,s.jsxs)("section",{id:"database-size-report",children:[(0,s.jsx)(b.A,{isLoading:F,params:G.largeObjects,title:"Database Size",data:H.largeObjects||[],queryType:"db",resolvedSql:U,renderer:e=>{var t;return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"col-span-4 inline-grid grid-cols-12 gap-12 w-full mt-5",children:[(0,s.jsxs)("div",{className:"grid gap-2 col-span-2",children:[(0,s.jsx)("h5",{className:"text-sm",children:"Space used"}),(0,s.jsx)("span",{className:"text-lg",children:(0,eL.z3)(V,2,"GB")})]}),(0,s.jsxs)("div",{className:"grid gap-2 col-span-2",children:[(0,s.jsx)("h5",{className:"text-sm",children:"Provisioned disk size"}),(0,s.jsxs)("span",{className:"text-lg",children:[W," GB"]})]}),(0,s.jsx)("div",{className:"col-span-8 text-right",children:(null==j?void 0:j.cloud_provider)==="AWS"?(0,s.jsx)(g.$,{asChild:!0,type:"default",children:(0,s.jsx)(p(),{href:"/project/".concat(v,"/settings/compute-and-disk"),children:"Increase disk size"})}):(0,s.jsx)(w.G,{type:"default",disabled:!$,onClick:()=>Y(!0),tooltip:{content:{side:"bottom",text:$?void 0:"You need additional permissions to increase the disk size"}},children:"Increase disk size"})})]}),(0,s.jsx)("h3",{className:"mt-8 text-sm",children:"Large Objects"}),!e.isLoading&&0===e.data.length&&(0,s.jsx)("span",{children:"No large objects found"}),!e.isLoading&&e.data.length>0&&(0,s.jsx)(C.A,{className:"space-y-3 mt-4",head:[(0,s.jsx)(C.A.th,{className:"py-2",children:"Object"},"object"),(0,s.jsx)(C.A.th,{className:"py-2",children:"Size"},"size")],body:null==(t=e.data)?void 0:t.map(e=>{let t=(e.table_size/V*100).toFixed(2);return(0,s.jsxs)(C.A.tr,{children:[(0,s.jsxs)(C.A.td,{children:[e.schema_name,".",e.relname]}),(0,s.jsxs)(C.A.td,{children:[(0,eL.z3)(e.table_size)," (",t,"%)"]})]},"".concat(e.schema_name,".").concat(e.relname))})})]})},append:()=>(0,s.jsx)("div",{className:"px-6 pb-6",children:(0,s.jsx)(f.Fc,{variant:"default",className:"mt-4",children:(0,s.jsx)(f.TN,{children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{children:"New Supabase projects have a database size of ~40-60mb. This space includes pre-installed extensions, schemas, and default Postgres data. Additional database size is used when installing extensions, even if those extensions are inactive."}),(0,s.jsx)(g.$,{asChild:!0,type:"default",icon:(0,s.jsx)(u.A,{}),children:(0,s.jsx)(p(),{href:"https://supabase.com/docs/guides/platform/database-size#disk-space-usage",target:"_blank",rel:"noreferrer",children:"Read about database size"})})]})})})}),"data-sentry-element":"ReportWidget","data-sentry-source-file":"database.tsx"}),(0,s.jsx)(_.A,{visible:Q,loading:es,hideModal:Y,"data-sentry-element":"DiskSizeConfigurationModal","data-sentry-source-file":"database.tsx"})]})]})}},31870:(e,t,a)=>{"use strict";a.d(t,{c:()=>r});var s=a(25718);function r(){let e=(0,s.a)();return e?{plan:null==e?void 0:e.plan,usageBillingEnabled:null==e?void 0:e.usage_billing_enabled,isLoading:!1,isSuccess:!0}:{plan:null,usageBillingEnabled:null,isLoading:!0,isSuccess:!1}}},37427:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(47370).A)("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]])},45571:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var s=a(56947),r=a(53434),i=a.n(r),l=a(3807),n=a(55319);async function o(e,t){let{projectRef:a,attribute:s,startDate:r,endDate:i,interval:n="1d",databaseIdentifier:o}=e;if(!a)throw Error("Project ref is required");if(!s)throw Error("Attribute is required");if(!r)throw Error("Start date is required");if(!i)throw Error("End date is required");let{data:d,error:c}=await (0,l.Jt)("/platform/projects/{ref}/daily-stats",{params:{path:{ref:a},query:{attribute:s,startDate:r,endDate:i,interval:n}},signal:t});return c&&(0,l.H4)(c),d}let d=function(e){let{projectRef:t,attribute:a,startDate:r,endDate:l,interval:d="1d",dateFormat:c="DD MMM",databaseIdentifier:u,modifier:m}=e,{enabled:p=!0,...h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(n.P.infraMonitoring(t,{attribute:a,startDate:r,endDate:l,interval:d,databaseIdentifier:u}),e=>{let{signal:s}=e;return o({projectRef:t,attribute:a,startDate:r,endDate:l,interval:d,databaseIdentifier:u},s)},{enabled:p&&void 0!==t&&void 0!==a&&void 0!==r&&void 0!==l,select:e=>({...e,data:e.data.map(e=>({...e,[a]:void 0!==m?m(Number(e[a])):Number(e[a]),periodStartFormatted:i()(e.period_start).format(c)}))}),staleTime:6e4,...h})}},49018:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var s=a(80263),r=a(9678),i=a(66452),l=a(52385),n=a(89044),o=a(41960),d=a(2),c=a(3732),u=a(16601),m=a(58135);let p=e=>{let t=(0,l.useRouter)(),{ref:a}=(0,n.g)();return(0,s.jsxs)(o.A,{noMargin:!0,noHideOverflow:!0,className:(0,d.cn)("pb-0",e.className),wrapWithLoading:!1,"data-sentry-element":"Panel","data-sentry-component":"ReportWidget","data-sentry-source-file":"ReportWidget.tsx",children:[(0,s.jsxs)(o.A.Content,{className:"space-y-4","data-sentry-element":"unknown","data-sentry-source-file":"ReportWidget.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-row items-start justify-between",children:[(0,s.jsxs)("div",{className:"gap-2",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,s.jsx)("h3",{className:"w-full h-6",children:e.title})," ",(null==e?void 0:e.tooltip)&&(0,s.jsxs)(c.m_,{children:[(0,s.jsx)(c.k$,{children:(0,s.jsx)(r.A,{className:"text-foreground-light",size:14,strokeWidth:1.5})}),(0,s.jsx)(c.ZI,{side:"bottom",children:e.tooltip})]})]}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:e.description})]}),e.params&&(0,s.jsxs)(c.m_,{children:[(0,s.jsx)(c.k$,{asChild:!0,children:(0,s.jsx)(u.$,{type:"default",icon:(0,s.jsx)(i.A,{}),className:"px-1",onClick:()=>{let s="db"===e.queryType,r=s?"/project/".concat(a,"/sql/new"):"/project/".concat(a,"/logs/explorer"),i={};if(s)i.content=e.resolvedSql;else{var l;i.q=null==(l=e.params)?void 0:l.sql,i.its=e.params.iso_timestamp_start,i.ite=e.params.iso_timestamp_end}t.push({pathname:r,query:i})}})}),(0,s.jsx)(c.ZI,{side:"left",children:"db"===e.queryType?"Open in SQL Editor":"Open in Logs Explorer"})]})]}),(0,s.jsx)(m.A,{active:e.isLoading,"data-sentry-element":"Loading","data-sentry-source-file":"ReportWidget.tsx",children:void 0===e.data?null:e.renderer({...e,router:t,projectRef:a})})]}),e.append&&(0,s.jsx)(s.Fragment,{children:e.append({...e,...e.appendProps||{},router:t,projectRef:a})})]})}},49089:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(80263),r=a(52385),i=a(89044),l=a(37518);let n=e=>{let{title:t,showDatabaseSelector:a}=e,n=(0,r.useRouter)(),{ref:o}=(0,i.g)(),{db:d,chart:c,...u}=n.query;return(0,s.jsxs)("div",{className:"flex flex-row justify-between gap-4 items-center","data-sentry-component":"ReportHeader","data-sentry-source-file":"ReportHeader.tsx",children:[(0,s.jsx)("h1",{className:"text-2xl text-foreground",children:t}),a&&(0,s.jsx)(l.A,{onSelectId:e=>{n.push({pathname:n.pathname,query:e!==o?{...u,db:e}:u})}})]})}},54045:(e,t,a)=>{"use strict";a.d(t,{A:()=>v});var s=a(80263),r=a(53239),i=a(53434),l=a.n(i),n=a(99212),o=a(13862),d=a(55433),c=a(42417),u=a(53190),m=a(37475),p=a(67435),h=a(15618),g=a(9603),f=a(83455),y=a(84430),x=a(45168);let v=e=>{var t,a,i;let{data:v,yAxisKey:b,xAxisKey:_,format:j,customDateFormat:A=g.C_.FULL,title:k,highlightedValue:C,highlightedLabel:w,displayDateInUtc:N,minimalHeader:S,valuePrecision:I,className:P="",size:E="normal",emptyStateMessage:D,onBarClick:T,showLegend:R=!1,xAxisIsDate:M=!0,XAxisProps:L,YAxisProps:q,showGrid:z=!1}=e,{Container:O}=(0,y.dQ)(E),[B,H]=(0,r.useState)(null),G=(0,r.useMemo)(()=>v.map(e=>({...e,[b]:"string"==typeof e[b]?Number(e[b]):e[b]})),[v,b]),U=L||{interval:v.length-2,angle:0,tick:!1},F=q||{tickFormatter:e=>(0,y.Eg)(e,I),tick:!1,width:0},K=e=>N?l()(e).utc():l()(e),X=function(){if(!M){var e;return B?null==(e=v[B])?void 0:e[_]:w}return null!==B&&v&&void 0!==v[B]&&K(v[B][_]).format(A)||w}(),V=null!==B?null==(t=v[B])?void 0:t[b]:C;return 0===v.length?(0,s.jsx)(x.A,{message:D,description:"It may take up to 24 hours for data to refresh",size:E,className:P,attribute:k,format:j}):(0,s.jsxs)("div",{className:["flex flex-col gap-y-3",P].join(" "),"data-sentry-component":"BarChart","data-sentry-source-file":"BarChart.tsx",children:[(0,s.jsx)(f.A,{title:k,format:j,customDateFormat:A,highlightedValue:"number"==typeof V?(0,y.Eg)(V,I):V,highlightedLabel:X,minimalHeader:S,"data-sentry-element":"ChartHeader","data-sentry-source-file":"BarChart.tsx"}),(0,s.jsx)(O,{"data-sentry-element":"Container","data-sentry-source-file":"BarChart.tsx",children:(0,s.jsxs)(n.E,{data:G,className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==B&&H(e.activeTooltipIndex)},onMouseLeave:()=>H(null),onClick:e=>{var t,a;let s=null==e||null==(a=e.activePayload)||null==(t=a[0])?void 0:t.payload;T&&T(s,e)},"data-sentry-element":"RechartBarChart","data-sentry-source-file":"BarChart.tsx",children:[R&&(0,s.jsx)(o.s,{}),z&&(0,s.jsx)(d.d,{stroke:g.OK.AXIS}),(0,r.createElement)(c.h,{...F,axisLine:{stroke:g.OK.AXIS},tickLine:{stroke:g.OK.AXIS},key:b,"data-sentry-element":"YAxis","data-sentry-source-file":"BarChart.tsx"}),(0,r.createElement)(u.W,{...U,axisLine:{stroke:g.OK.AXIS},tickLine:{stroke:g.OK.AXIS},key:_,"data-sentry-element":"XAxis","data-sentry-source-file":"BarChart.tsx"}),(0,s.jsx)(m.m,{content:()=>null,"data-sentry-element":"Tooltip","data-sentry-source-file":"BarChart.tsx"}),(0,s.jsx)(p.y,{dataKey:b,fill:g.OK.GREEN_1,animationDuration:300,maxBarSize:48,"data-sentry-element":"Bar","data-sentry-source-file":"BarChart.tsx",children:null==v?void 0:v.map((e,t)=>(0,s.jsx)(h.f,{className:"transition-all duration-300 ".concat(T?"cursor-pointer":""),fill:B===t||null===B?g.OK.GREEN_1:g.OK.GREEN_2,enableBackground:12},"cell-".concat(t)))})]})}),v&&(0,s.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{children:M?K(v[0][_]).format(A):v[0][_]}),(0,s.jsx)("span",{children:M?K(null==(a=v[(null==v?void 0:v.length)-1])?void 0:a[_]).format(A):null==(i=v[(null==v?void 0:v.length)-1])?void 0:i[_]})]})]})}},55319:(e,t,a)=>{"use strict";a.d(t,{P:()=>s});let s={warehouseQuery:(e,t)=>["projects",e,"warehouse","query",t],warehouseTenant:e=>["projects",e,"warehouse","tenant"],warehouseCollections:e=>["projects",e,"warehouse","collections"],warehouseCollectionsCreate:e=>["projects",e,"warehouse","collections","create"],warehouseEndpoints:e=>["projects",e,"warehouse","endpoints"],warehouseBackends:e=>["projects",e,"warehouse","backends"],warehouseAccessTokens:e=>["projects",e,"warehouse","access-tokens"],functionsInvStats:(e,t)=>{let{interval:a,functionId:s}=t;return["projects",e,"functions-inv-stats",{interval:a,functionId:s}]},functionsReqStats:(e,t)=>{let{interval:a,functionId:s}=t;return["projects",e,"functions-req-stats",{interval:a,functionId:s}]},functionsResourceUsage:(e,t)=>{let{interval:a,functionId:s}=t;return["projects",e,"functions-resource-usage",{interval:a,functionId:s}]},orgDailyComputeStats:(e,t)=>{let{startDate:a,endDate:s,projectRef:i}=t;return["organizations",e,"daily-stats-compute",{startDate:r(a),endDate:r(s),projectRef:i}]},orgDailyStats:(e,t)=>{let{metric:a,startDate:s,endDate:i,interval:l,projectRef:n}=t;return["organizations",e,"daily-stats",{metric:a,startDate:r(s),endDate:r(i),interval:l,projectRef:n}]},infraMonitoring:(e,t)=>{let{attribute:a,startDate:s,endDate:r,interval:i,databaseIdentifier:l}=t;return["projects",e,"infra-monitoring",{attribute:a,startDate:s,endDate:r,interval:i,databaseIdentifier:l}]},usageApiCounts:(e,t)=>["projects",e,"usage.api-counts",t],usageApiRequestsCount:e=>["projects",e,"usage.api-requests-count"]};function r(e){return e?e.split("T")[0]:e}},60555:(e,t,a)=>{"use strict";a.d(t,{Cb:()=>c,L3:()=>u,PJ:()=>m,QP:()=>p,wG:()=>d});var s=a(80263),r=a(40900),i=a(90235),l=a(42043),n=a(73634),o=a(3993);let d={API:{label:"All API usage",icon:e=>(0,s.jsx)(i.A,{size:16,className:e}),key:"api"},API_DATABASE:{label:"Database API",icon:e=>(0,s.jsx)(l.A,{size:16,className:e}),key:"api_database"},API_AUTH:{label:"Authentication",icon:e=>(0,s.jsx)(r.Nj,{size:16,className:e}),key:"api_auth"},API_STORAGE:{label:"Storage",icon:e=>(0,s.jsx)(r.wc,{size:16,className:e}),key:"api_storage"},API_REALTIME:{label:"Realtime",icon:e=>(0,s.jsx)(r.Se,{size:16,className:e}),key:"api_realtime"},INSTANCE:{label:"Instance health",icon:e=>(0,s.jsx)(n.A,{size:16,className:e}),key:"instance"},SUPAVISOR:{label:"Supavisor",icon:e=>(0,s.jsx)(o.A,{size:16,className:e}),key:"supavisor"}},c=[{key:"avg_cpu_usage",label:"Average CPU % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"max_cpu_usage",label:"Max CPU % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"disk_io_consumption",label:"Disk IO % Consumed",provider:"infra-monitoring",category:d.INSTANCE},{key:"disk_io_budget",label:"Disk IO % Remaining",provider:"infra-monitoring",category:d.INSTANCE},{key:"ram_usage",label:"Memory % Usage",provider:"infra-monitoring",category:d.INSTANCE},{key:"total_realtime_egress",label:"Realtime Connection Egress",provider:"daily-stats",category:d.API},{key:"total_realtime_requests",label:"Realtime Connection Requests",provider:"daily-stats",category:d.API_REALTIME},{key:"total_realtime_ingress",label:"Realtime Connection Ingress",provider:"daily-stats",category:d.API_REALTIME},{key:"total_rest_ingress",label:"API Ingress",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_egress",label:"API Egress",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_requests",label:"API Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_get_requests",label:"API GET Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_post_requests",label:"API POST Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_patch_requests",label:"API PATCH Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_delete_requests",label:"API DELETE Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_rest_options_requests",label:"API OPTIONS Requests",provider:"daily-stats",category:d.API_DATABASE},{key:"total_auth_billing_period_mau",label:"Auth Monthly Active User",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_billing_period_sso_mau",label:"Auth Monthly Active SSO User",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_ingress",label:"Auth Ingress",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_egress",label:"Auth Egress",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_requests",label:"Auth Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_get_requests",label:"Auth GET Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_post_requests",label:"Auth POST Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_patch_requests",label:"Auth PATCH Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_auth_options_requests",label:"Auth OPTIONS Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_storage_ingress",label:"Storage Ingress",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_egress",label:"Storage Egress",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_image_render_count",label:"Storage Image Transformations",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_requests",label:"Storage Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_get_requests",label:"Storage GET Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_post_requests",label:"Storage POST Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_delete_requests",label:"Storage DELETE Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_storage_options_requests",label:"Storage OPTIONS Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_auth_delete_requests",label:"Auth DELETE Requests",provider:"daily-stats",category:d.API_AUTH},{key:"total_egress",label:"All Egress",provider:"daily-stats",category:d.API},{key:"total_get_requests",label:"All GET Requests",provider:"daily-stats",category:d.API},{key:"total_storage_patch_requests",label:"Storage PATCH Requests",provider:"daily-stats",category:d.API_STORAGE},{key:"total_requests",label:"All Requests",provider:"daily-stats",category:d.API},{key:"total_patch_requests",label:"All PATCH Requests",provider:"daily-stats",category:d.API},{key:"total_post_requests",label:"All POST Requests",provider:"daily-stats",category:d.API},{key:"total_ingress",label:"All Ingress",provider:"daily-stats",category:d.API},{key:"total_delete_requests",label:"All DELETE Requests",provider:"daily-stats",category:d.API},{key:"total_options_requests",label:"All OPTIONS Requests",provider:"daily-stats",category:d.API},{key:"total_supavisor_egress_bytes",label:"Shared Pooler Egress",provider:"daily-stats",category:d.SUPAVISOR}],u=[{key:"currentBillingCycle",label:"Current billing cycle",interval:"1d"},{key:"previousBillingCycle",label:"Previous billing cycle",interval:"1d"}],m=[{key:"7d",label:"Last 7 days",interval:"1d"},{key:"30d",label:"Last 30 days",interval:"1d"},{key:"startMonth",label:"This month",interval:"1d"}],p=[{key:"10m",label:"Last 10 minutes"},{key:"30m",label:"Last 30 minutes"},{key:"1h",label:"Last hour"},{key:"3h",label:"Last 3 hours"},{key:"1d",label:"Last 24 hours"},{key:"7d",label:"Last 7 days"}]},72225:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var s=a(80263),r=a(53434),i=a.n(r),l=a(53239),n=a(8594),o=a(53190),d=a(37475),c=a(98140),u=a(9603),m=a(83455),p=a(84430),h=a(45168);let g=e=>{var t,a;let{data:r,yAxisKey:g,xAxisKey:f,format:y,customDateFormat:x=u.C_.FULL,title:v,highlightedValue:b,highlightedLabel:_,displayDateInUtc:j,minimalHeader:A,className:k="",valuePrecision:C,size:w="normal"}=e,{Container:N}=(0,p.dQ)(w),[S,I]=(0,l.useState)(null),P=null!==S&&r&&void 0!==r[S]&&(e=>j?i()(e).utc():i()(e))(r[S][f]).format(x)||_,E=null!==S?null==(t=r[S])?void 0:t[g]:b;return 0===r.length?(0,s.jsx)(h.A,{description:"It may take up to 24 hours for data to refresh",size:w,className:k,attribute:v,format:y}):(0,s.jsxs)("div",{className:["flex flex-col gap-3",k].join(" "),"data-sentry-component":"AreaChart","data-sentry-source-file":"AreaChart.tsx",children:[(0,s.jsx)(m.A,{title:v,format:y,customDateFormat:x,highlightedValue:"number"==typeof E?(0,p.Eg)(E,C):E,highlightedLabel:P,minimalHeader:A,"data-sentry-element":"ChartHeader","data-sentry-source-file":"AreaChart.tsx"}),(0,s.jsx)(N,{"data-sentry-element":"Container","data-sentry-source-file":"AreaChart.tsx",children:(0,s.jsxs)(n.Q,{data:r,margin:{top:0,right:0,left:0,bottom:0},className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==S&&I(e.activeTooltipIndex)},onMouseLeave:()=>I(null),"data-sentry-element":"RechartAreaChart","data-sentry-source-file":"AreaChart.tsx",children:[(0,s.jsx)("defs",{"data-sentry-element":"defs","data-sentry-source-file":"AreaChart.tsx",children:(0,s.jsxs)("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1","data-sentry-element":"linearGradient","data-sentry-source-file":"AreaChart.tsx",children:[(0,s.jsx)("stop",{offset:"5%",stopColor:u.OK.GREEN_1,stopOpacity:.8,"data-sentry-element":"stop","data-sentry-source-file":"AreaChart.tsx"}),(0,s.jsx)("stop",{offset:"95%",stopColor:u.OK.GREEN_1,stopOpacity:0,"data-sentry-element":"stop","data-sentry-source-file":"AreaChart.tsx"})]})}),(0,s.jsx)(o.W,{dataKey:f,interval:r.length-2,angle:0,tick:!1,axisLine:{stroke:u.OK.AXIS},tickLine:{stroke:u.OK.AXIS},"data-sentry-element":"XAxis","data-sentry-source-file":"AreaChart.tsx"}),(0,s.jsx)(d.m,{content:()=>null,"data-sentry-element":"Tooltip","data-sentry-source-file":"AreaChart.tsx"}),(0,s.jsx)(c.G,{type:"monotone",dataKey:g,stroke:u.OK.GREEN_1,fillOpacity:1,fill:"url(#colorUv)","data-sentry-element":"Area","data-sentry-source-file":"AreaChart.tsx"})]})}),r&&(0,s.jsxs)("div",{className:"text-foreground-lighter -mt-8 flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{children:i()(r[0][f]).format(x)}),(0,s.jsx)("span",{children:i()(null==(a=r[(null==r?void 0:r.length)-1])?void 0:a[f]).format(x)})]})]})}},72821:(e,t,a)=>{"use strict";a.d(t,{F:()=>d});var s=a(32144),r=a(80251),i=a(73969),l=a(3807),n=a(10358);async function o(e){let{projectRef:t,volumeSize:a}=e;if(!t)throw Error("projectRef is required");let{data:s,error:r}=await (0,l.bE)("/platform/projects/{ref}/resize",{params:{path:{ref:t}},body:{volume_size_gb:a}});return r&&(0,l.H4)(r),s}let d=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,s.jE)();return(0,r.n)(e=>o(e),{async onSuccess(t,a,s){let{projectRef:r}=a;l.setQueriesData(n.E.usage(r),e=>e?{...e,disk_volume_size_gb:a.volumeSize}:e),await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?i.oR.error("Failed to resize project disk: ".concat(e.message)):t(e,a,s)},...a})}},84876:(e,t,a)=>{"use strict";a.d(t,{B:()=>l,p:()=>i});var s=a(8571),r=a(11558);let i=e=>Object.fromEntries(new URLSearchParams(e)),l=(e,t)=>Object.entries(e).reduce((e,a)=>{let[i,{sql:l,queryType:n}]=a;return"db"===n?{...e,[i]:()=>(0,s.A)({sql:l})}:{...e,[i]:()=>(0,r.A)(t)}},{})},85025:(e,t,a)=>{"use strict";a.d(t,{q:()=>d});var s=a(56947),r=a(53434),i=a.n(r),l=a(3807),n=a(55319);async function o(e,t){let{projectRef:a,attribute:s,startDate:r,endDate:i,interval:n="1h",databaseIdentifier:o}=e;if(!a)throw Error("Project ref is required");if(!s)throw Error("Attribute is required");if(!r)throw Error("Start date is required");if(!i)throw Error("End date is required");let{data:d,error:c}=await (0,l.Jt)("/platform/projects/{ref}/infra-monitoring",{params:{path:{ref:a},query:{attribute:s,startDate:r,endDate:i,interval:n,databaseIdentifier:o}},signal:t});return c&&(0,l.H4)(c),d}let d=function(e){let{projectRef:t,attribute:a,startDate:r,endDate:l,interval:d="1h",dateFormat:c="HH:mm DD MMM",databaseIdentifier:u,modifier:m}=e,{enabled:p=!0,...h}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(n.P.infraMonitoring(t,{attribute:a,startDate:r,endDate:l,interval:d,databaseIdentifier:u}),e=>{let{signal:s}=e;return o({projectRef:t,attribute:a,startDate:r,endDate:l,interval:d,databaseIdentifier:u},s)},{enabled:p&&void 0!==t&&void 0!==a&&void 0!==r&&void 0!==l,select:e=>({...e,data:e.data.map(e=>({...e,[a]:void 0!==m?m(Number(e[a])):Number(e[a]),periodStartFormatted:i()(e.period_start).format(c)}))}),staleTime:6e4,...h})}},91128:(e,t,a)=>{"use strict";a.d(t,{Gw:()=>o});var s=a(56947),r=a(77570),i=a(68324);let l=()=>"\nselect sum(pg_database_size(pg_database.datname))::bigint as db_size from pg_database;\n".trim();async function n(e,t){var a;let{projectRef:s,connectionString:i}=e,n=l(),{result:o}=await (0,r.E)({projectRef:s,connectionString:i,sql:n,queryKey:["database-size"]},t),d=null==o||null==(a=o[0])?void 0:a.db_size;if("number"!=typeof d)throw Error("Error fetching dbSize");return d}let o=function(e){let{projectRef:t,connectionString:a}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)(i.c.databaseSize(t),e=>{let{signal:s}=e;return n({projectRef:t,connectionString:a},s)},{enabled:r&&void 0!==t,...l})}},97851:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(80263),r=a(53239),i=a(48591),l=a(33745),n=a(71787),o=a(77690),d=a(34214);let c=function(e){let{defaultValue:t,descriptionText:a,error:c,icon:u,inputRef:m,label:p,afterLabel:h,beforeLabel:g,labelOptional:f,layout:y,value:x,actions:v,size:b="medium",validation:_,id:j="",name:A="",...k}=e,C=(0,o.A)("inputNumber"),{formContextOnChange:w,values:N,errors:S,handleBlur:I,touched:P,fieldLevelValidation:E}=(0,d.x)();N&&!x&&(x=N[j||A]),c||(S&&!c&&(c=S[j||A]),c=P&&P[j||A]?c:void 0),(0,r.useEffect)(()=>{_&&E(j,_(x))},[]);let D=[C.base];return c&&D.push(C.variants.error),c||D.push(C.variants.standard),u&&D.push(C.with_icon),b&&D.push(C.size[b]),k.disabled&&D.push(C.disabled),(0,s.jsx)("div",{className:k.className,"data-sentry-component":"InputNumber","data-sentry-source-file":"InputNumber.tsx",children:(0,s.jsx)(i.H,{label:p,afterLabel:h,beforeLabel:g,labelOptional:f,layout:y,id:j,error:c,descriptionText:a,style:k.style,size:b,"data-sentry-element":"FormLayout","data-sentry-source-file":"InputNumber.tsx",children:(0,s.jsxs)("div",{className:C.container,children:[(0,s.jsx)("input",{"data-size":b,id:j,name:A,onChange:function(e){k.onChange&&k.onChange(e),w&&w(e),_&&E(j,_(e.target.value))},onBlur:function(e){I&&I(e),k.onBlur&&k.onBlur(e)},type:"number",ref:m,value:x,className:D.join(" "),...k}),u&&(0,s.jsx)(n.A,{size:b,icon:u}),c||v?(0,s.jsxs)("div",{className:C.actions_container,children:[c&&(0,s.jsx)(l.A,{size:b}),v&&v]}):null]})})})}},98536:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/reports/database",function(){return a(19842)}])},99985:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(47370).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[89,2479,8058,9353,9413,3730,6110,6182,589,9257,1673,5599,7990,8508,4365,2981,7406,6554,4560,4963,408,4340,30,2809,6692,5165,5969,3719,9472,9088,3423,1252,7613,8601,4006,6593,636,8792],()=>t(98536)),_N_E=e.O()}]);