!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d491afa7-33a4-4c58-b477-5d91763bee57",e._sentryDebugIdIdentifier="sentry-dbid-d491afa7-33a4-4c58-b477-5d91763bee57")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4006],{32933:(e,t,s)=>{s.d(t,{EV:()=>c,NY:()=>u,bR:()=>l,cO:()=>o,ig:()=>m,xm:()=>i});var n=s(53434),a=s.n(n),r=s(77153);let o=2,i=[{text:"Last 10 minutes",calcFrom:()=>a()().subtract(10,"minute").toISOString(),calcTo:()=>a()().toISOString(),availableIn:["team","enterprise"]},{text:"Last 30 minutes",calcFrom:()=>a()().subtract(30,"minute").toISOString(),calcTo:()=>a()().toISOString(),availableIn:["team","enterprise"]},{text:"Last 60 minutes",calcFrom:()=>a()().subtract(1,"hour").startOf("day").toISOString(),calcTo:()=>a()().toISOString(),default:!0,availableIn:["free","pro","team","enterprise"]},{text:"Last 3 hours",calcFrom:()=>a()().subtract(3,"hour").startOf("day").toISOString(),calcTo:()=>a()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 24 hours",calcFrom:()=>a()().subtract(1,"day").startOf("day").toISOString(),calcTo:()=>a()().toISOString(),availableIn:["free","pro","team","enterprise"]},{text:"Last 7 days",calcFrom:()=>a()().subtract(7,"day").startOf("day").toISOString(),calcTo:()=>"",availableIn:["pro","team","enterprise"]},{text:"Last 14 days",calcFrom:()=>a()().subtract(14,"day").startOf("day").toISOString(),calcTo:()=>"",availableIn:["team","enterprise"]},{text:"Last 28 days",calcFrom:()=>a()().subtract(28,"day").startOf("day").toISOString(),calcTo:()=>"",availableIn:["team","enterprise"]}],l=e=>i.map(t=>{var s;return{...t,disabled:!(null==(s=t.availableIn)?void 0:s.includes(e))}}),c={iso_timestamp_start:i[0].calcFrom(),iso_timestamp_end:i[0].calcTo()},d=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(0===e.length)return"";let s=e.map(e=>{let t=e.key.split("."),s=[t[t.length-2],t[t.length-1]].join("."),n=e.key.includes(".")?s:e.key;return"matches"===e.compare?"REGEXP_CONTAINS(".concat(n,", '").concat(e.value,"')"):"is"===e.compare?"".concat(n," = ").concat(e.value):void 0}).join(" AND ");return t?"WHERE "+s:"AND "+s},u={[r.N.API]:{title:"API",queries:{totalRequests:{queryType:"logs",sql:e=>"\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          count(t.id) as count\n        FROM edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(d(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC")},topRoutes:{queryType:"logs",sql:e=>"\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(d(e),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          count desc\n        limit 10\n        ")},errorCounts:{queryType:"logs",sql:e=>"\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          count(t.id) as count\n        FROM edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        WHERE\n          response.status_code >= 400\n        ".concat(d(e,!1),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n        ")},topErrorRoutes:{queryType:"logs",sql:e=>"\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        where\n          response.status_code >= 400\n        ".concat(d(e,!1),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          count desc\n        limit 10\n        ")},responseSpeed:{queryType:"logs",sql:e=>"\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          avg(response.origin_time) as avg\n        FROM\n          edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          ".concat(d(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n      ")},topSlowRoutes:{queryType:"logs",sql:e=>"\n        select\n          request.path as path,\n          request.method as method,\n          request.search as search,\n          response.status_code as status_code,\n          count(t.id) as count,\n          avg(response.origin_time) as avg\n        from edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n        ".concat(d(e),"\n        group by\n          request.path, request.method, request.search, response.status_code\n        order by\n          avg desc\n        limit 10\n        ")},networkTraffic:{queryType:"logs",sql:e=>'\n        select\n          cast(timestamp_trunc(t.timestamp, hour) as datetime) as timestamp,\n          coalesce(\n            safe_divide(\n              sum(\n                cast(coalesce(headers.content_length, "0") as int64)\n              ),\n              1000000\n            ),\n            0\n          ) as ingress_mb,\n          coalesce(\n            safe_divide(\n              sum(\n                cast(coalesce(resp_headers.content_length, "0") as int64)\n              ),\n              1000000\n            ),\n            0\n          ) as egress_mb,\n        FROM\n          edge_logs t\n          cross join unnest(metadata) as m\n          cross join unnest(m.response) as response\n          cross join unnest(m.request) as request\n          cross join unnest(request.headers) as headers\n          cross join unnest(response.headers) as resp_headers\n          '.concat(d(e),"\n        GROUP BY\n          timestamp\n        ORDER BY\n          timestamp ASC\n        ")}}},[r.N.AUTH]:{title:"",queries:{}},[r.N.STORAGE]:{title:"Storage",queries:{cacheHitRate:{queryType:"logs",sql:e=>"\n-- cache-hit-rate\nSELECT\n  timestamp_trunc(timestamp, hour) as timestamp,\n  countif( h.cf_cache_status in ('HIT', 'STALE', 'REVALIDATED', 'UPDATING') ) as hit_count,\n  countif( h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC') ) as miss_count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object') and r.method = 'GET'\ngroup by timestamp\norder by timestamp desc\n"},topCacheMisses:{queryType:"logs",sql:e=>"\n-- top-cache-misses\nSELECT\n  r.path as path,\n  r.search as search,\n  count(id) as count\nfrom edge_logs f\n  cross join unnest(f.metadata) as m\n  cross join unnest(m.request) as r\n  cross join unnest(m.response) as res\n  cross join unnest(res.headers) as h\nwhere starts_with(r.path, '/storage/v1/object') \n  and r.method = 'GET'\n  and h.cf_cache_status in ('MISS', 'NONE/UNKNOWN', 'EXPIRED', 'BYPASS', 'DYNAMIC')\ngroup by path, search\norder by count desc\nlimit 12\n    "}}},[r.N.QUERY_PERFORMANCE]:{title:"Query performance",queries:{mostFrequentlyInvoked:{queryType:"db",sql:function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n-- Most frequently called queries\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    -- -- Postgres 13, 14, 15\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    statements.min_exec_time + statements.min_plan_time as min_time,\n    statements.max_exec_time + statements.max_plan_time as max_time,\n    statements.mean_exec_time + statements.mean_plan_time as mean_time,\n    -- -- Postgres <= 12\n    -- total_time,\n    -- min_time,\n    -- max_time,\n    -- mean_time,\n    statements.rows / statements.calls as avg_rows".concat(n?",\n    case \n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(s||"order by statements.calls desc","\n  limit 20")}},mostTimeConsuming:{queryType:"db",sql:function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n-- Most time consuming queries\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    to_char(((statements.total_exec_time + statements.total_plan_time)/sum(statements.total_exec_time + statements.total_plan_time) OVER()) * 100, 'FM90D0') || '%'  AS prop_total_time".concat(n?",\n    case \n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(s||"order by total_time desc","\n  limit 20")}},slowestExecutionTime:{queryType:"db",sql:function(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return"\n-- Slowest queries by max execution time\nset search_path to public, extensions;\n\nselect\n    auth.rolname,\n    statements.query,\n    statements.calls,\n    -- -- Postgres 13, 14, 15\n    statements.total_exec_time + statements.total_plan_time as total_time,\n    statements.min_exec_time + statements.min_plan_time as min_time,\n    statements.max_exec_time + statements.max_plan_time as max_time,\n    statements.mean_exec_time + statements.mean_plan_time as mean_time,\n    -- -- Postgres <= 12\n    -- total_time,\n    -- min_time,\n    -- max_time,\n    -- mean_time,\n    statements.rows / statements.calls as avg_rows".concat(n?",\n    case \n      when (lower(statements.query) like 'select%' or lower(statements.query) like 'with pgrst%')\n      then (\n        select json_build_object(\n          'has_suggestion', array_length(index_statements, 1) > 0,\n          'startup_cost_before', startup_cost_before,\n          'startup_cost_after', startup_cost_after,\n          'total_cost_before', total_cost_before,\n          'total_cost_after', total_cost_after,\n          'index_statements', index_statements\n        )\n        from index_advisor(statements.query)\n      )\n      else null\n    end as index_advisor_result":"","\n  from pg_stat_statements as statements\n    inner join pg_authid as auth on statements.userid = auth.oid\n  ").concat(t||"","\n  ").concat(s||"order by max_time desc","\n  limit 20")}},queryHitRate:{queryType:"db",sql:e=>"-- Cache and index hit rate\nselect\n    'index hit rate' as name,\n    (sum(idx_blks_hit)) / nullif(sum(idx_blks_hit + idx_blks_read),0) as ratio\n  from pg_statio_user_indexes\n  union all\n  select\n    'table hit rate' as name,\n    sum(heap_blks_hit) / nullif(sum(heap_blks_hit) + sum(heap_blks_read),0) as ratio\n  from pg_statio_user_tables;"}}},[r.N.DATABASE]:{title:"database",queries:{largeObjects:{queryType:"db",sql:e=>"SELECT \n        SCHEMA_NAME,\n        relname,\n        table_size\n      FROM\n        (SELECT \n          pg_catalog.pg_namespace.nspname AS SCHEMA_NAME,\n          relname,\n          pg_total_relation_size(pg_catalog.pg_class.oid) AS table_size\n        FROM pg_catalog.pg_class\n        JOIN pg_catalog.pg_namespace ON relnamespace = pg_catalog.pg_namespace.oid\n        ) t\n      WHERE SCHEMA_NAME NOT LIKE 'pg_%'\n      ORDER BY table_size DESC\n      LIMIT 5;"}}}},m=["total_realtime_ingress","total_rest_options_requests","total_auth_ingress","total_auth_get_requests","total_auth_post_requests","total_auth_patch_requests","total_auth_options_requests","total_storage_options_requests","total_storage_patch_requests","total_options_requests"]},42677:(e,t,s)=>{s.d(t,{Ay:()=>m});var n=s(80263),a=s(53239),r=s(77690),o=s(2);function i(e){let{children:t,className:s,tag:a="div",style:r}=e;return(0,n.jsx)("".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}i.Title=function(e){let{className:t,level:s=1,children:a,style:r}=e;return(0,n.jsx)("h".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:a})},i.Text=function(e){let{className:t,children:s,style:a,type:r,disabled:o,mark:i,code:l,keyboard:c,underline:d,strikethrough:u,strong:m,small:p}=e;return l?(0,n.jsx)("code",{style:a,children:s}):i?(0,n.jsx)("mark",{style:a,children:s}):c?(0,n.jsx)("kbd",{style:a,children:s}):m?(0,n.jsx)("strong",{style:a,children:s}):(0,n.jsx)("span",{style:a,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},i.Link=function(e){let{children:t,target:s="_blank",href:a,className:r,onClick:o,style:i}=e;return(0,n.jsx)("a",{onClick:o,href:a,target:s,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let l=(0,a.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,n.jsx)(l.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:s,ulClassName:a,style:r,type:o="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(c,{type:o,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:a,children:t})})})}u.Item=function(e){let{children:t,icon:s,active:a,rounded:i,onClick:l,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:m}=e,p=(0,r.A)("menu"),{type:h}=d(),_=[p.item.base];_.push(p.item.variants[h].base),a?_.push(p.item.variants[h].active):_.push(p.item.variants[h].normal);let x=[p.item.content.base];a?x.push(p.item.content.active):x.push(p.item.content.normal);let g=[p.item.icon.base];return a?g.push(p.item.icon.active):g.push(p.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,o.cn)("outline-none",_),style:m,onClick:l,"aria-current":a?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:s}),(0,n.jsx)("span",{className:x.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:s,title:a}=e,o=(0,r.A)("menu"),{type:i}=d();return(0,n.jsxs)("div",{className:[o.group.base,o.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("span",{className:o.group.icon,children:s}),(0,n.jsx)("span",{className:o.group.content,children:a}),t]})},u.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(i.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let m=u},45168:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(80263),a=s(31277),r=s(2),o=s(83455),i=s(84430);let l=e=>{let{attribute:t,message:s="No data to show",description:l,format:c,className:d="",size:u}=e,{minHeight:m}=(0,i.dQ)(u);return(0,n.jsxs)("div",{"data-sentry-component":"NoDataPlaceholder","data-sentry-source-file":"NoDataPlaceholder.tsx",children:[void 0!==t&&(0,n.jsx)(o.A,{title:t,format:c,highlightedValue:0}),(0,n.jsxs)("div",{className:(0,r.cn)("border-control flex flex-grow w-full flex-col items-center justify-center space-y-2 border border-dashed text-center",d),style:{minHeight:m+20},children:[(0,n.jsx)(a.A,{size:20,className:"text-border-stronger","data-sentry-element":"BarChart2","data-sentry-source-file":"NoDataPlaceholder.tsx"}),(0,n.jsxs)("div",{className:"px-1",children:[(0,n.jsx)("p",{className:"text-foreground-light text-xs",children:s}),l&&(0,n.jsx)("p",{className:"text-foreground-lighter text-xs",children:l})]})]})]})}},45259:(e,t,s)=>{s.d(t,{A:()=>F});var n=s(80263),a=s(29730),r=s(88601),o=s(60045),i=s(97318),l=s(63320),c=s.n(l),d=s(52385),u=s(53239),m=s(73969),p=s(89044),h=s(72793),_=s(83041),x=s(55335),g=s(80109),y=s(71171),f=s(16601);let j=e=>{let{selectedReport:t,initialValues:s,onCancel:a}=e,{ref:r}=(0,p.g)(),{mutate:o,isLoading:i}=(0,_.v)({onSuccess:()=>{m.oR.success("Successfully updated report"),a()},onError:e=>{m.oR.error("Failed to update report: ".concat(e.message))}});return(0,n.jsx)(x.A,{visible:void 0!==t,onCancel:a,hideFooter:!0,header:"Update custom report",size:"small","data-sentry-element":"Modal","data-sentry-component":"UpdateCustomReportModal","data-sentry-source-file":"UpdateModal.tsx",children:(0,n.jsx)(g.A,{onReset:a,validateOnBlur:!0,initialValues:s,validate:function(e){let t={};return e.name||(t.name="This field is required"),t},onSubmit:e=>{if(!r)return console.error("Project ref is required");t&&t.id&&t.project_id&&o({projectRef:r,payload:{...t,owner_id:t.owner_id,project_id:t.project_id,id:t.id,name:e.name,description:e.description||""}})},"data-sentry-element":"Form","data-sentry-source-file":"UpdateModal.tsx",children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.A.Content,{children:(0,n.jsx)(y.A,{label:"Name",id:"name",name:"name"})}),(0,n.jsx)(x.A.Content,{children:(0,n.jsx)(y.A.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})}),(0,n.jsx)(x.A.Separator,{}),(0,n.jsxs)(x.A.Content,{className:"flex items-center justify-end gap-2",children:[(0,n.jsx)(f.$,{htmlType:"reset",type:"default",onClick:a,disabled:i,children:"Cancel"}),(0,n.jsx)(f.$,{htmlType:"submit",loading:i,disabled:i,children:"Save custom report"})]})]})})})};var b=s(79319),v=s(17234),q=s(81737),S=s(78512),N=s(65904),A=s(45479),R=s(11649),C=s(42677),E=s(2),w=s(36212),T=s(68656),k=s(99985),O=s(94328),M=s(33656);let I=e=>{let{item:t,pageKey:s,onSelectEdit:a,onSelectDelete:r}=e,{profile:i}=(0,R.xc)(),l=(0,N.SE)(o.aG.UPDATE,"user_content",{resource:{type:"report",visibility:t.report.visibility,owner_id:t.report.owner_id},subject:{id:null==i?void 0:i.id}});return(0,n.jsxs)(c(),{className:(0,E.cn)("pr-2 h-7 pl-3 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",t.key===s?"bg-surface-300 text-foreground":"hover:bg-surface-200"),href:t.url,"data-sentry-element":"Link","data-sentry-component":"ReportMenuItem","data-sentry-source-file":"ReportMenuItem.tsx",children:[(0,n.jsx)("div",{children:t.name}),l&&(0,n.jsxs)(M.rI,{children:[(0,n.jsx)(M.ty,{asChild:!0,children:(0,n.jsx)(f.$,{type:"text",className:"px-1 opacity-50 hover:opacity-100",icon:(0,n.jsx)(T.A,{size:12,strokeWidth:2})})}),(0,n.jsxs)(M.SQ,{align:"start",className:"w-32 *:gap-x-2",children:[(0,n.jsxs)(M._2,{onClick:()=>{t.id&&a()},children:[(0,n.jsx)(k.A,{size:12}),(0,n.jsx)("div",{children:"Rename report"})]}),(0,n.jsx)(M.mB,{}),(0,n.jsxs)(M._2,{onClick:()=>{t.id&&r()},children:[(0,n.jsx)(O.A,{size:12}),(0,n.jsx)("div",{children:"Delete report"})]})]})]})]},t.key+"-menukey")},D=()=>{let e=(0,d.useRouter)(),{profile:t}=(0,R.xc)(),{ref:s,id:a}=(0,p.g)(),r=a||e.pathname.split("/")[4],l=(0,A.x)("project_storage:all"),_=(0,N.SE)(o.aG.CREATE,"user_content",{resource:{type:"report",owner_id:null==t?void 0:t.id},subject:{id:null==t?void 0:t.id}}),{data:x,isLoading:g}=(0,S.D)({projectRef:s,type:"report"}),{mutate:y,isLoading:f}=(0,q.$)({onSuccess:()=>{k(!1),m.oR.success("Successfully deleted report"),e.push("/project/".concat(s,"/reports"))},onError:e=>{m.oR.error("Failed to delete report: ".concat(e.message))}}),[T,k]=(0,u.useState)(!1),[O,M]=(0,u.useState)(!1),[D,F]=(0,u.useState)(),[P,L]=(0,u.useState)(),B=function(){if(!x)return[];let e=null==x?void 0:x.content.filter(e=>"report"===e.type);return(null==e?void 0:e.sort((e,t)=>e.name<t.name?-1:+(e.name>t.name))).map((e,t)=>({id:e.id,name:e.name,description:e.description||"",key:e.id||t+"-report",url:"/project/".concat(s,"/reports/").concat(e.id),hasDropdownActions:!0,report:e}))}(),H=[{title:"Built-in reports",key:"builtin-reports",items:[{name:"API",key:"api-overview",url:"/project/".concat(s,"/reports/api-overview")},...l?[{name:"Storage",key:"storage",url:"/project/".concat(s,"/reports/storage")}]:[],{name:"Database",key:"database",url:"/project/".concat(s,"/reports/database")}]}];return(0,n.jsx)(C.Ay,{type:"pills",className:"mt-6","data-sentry-element":"Menu","data-sentry-component":"ReportsMenu","data-sentry-source-file":"ReportsMenu.tsx",children:g?(0,n.jsxs)("div",{className:"px-5 my-4 space-y-2",children:[(0,n.jsx)(v.A,{}),(0,n.jsx)(v.A,{className:"w-3/4"}),(0,n.jsx)(v.A,{className:"w-1/2"})]}):(0,n.jsxs)("div",{className:"flex flex-col px-2 gap-y-6",children:[(0,n.jsx)("div",{className:"px-2",children:(0,n.jsx)(b.G,{block:!0,type:"default",icon:(0,n.jsx)(i.A,{}),disabled:!_,className:"justify-start flex-grow",onClick:()=>{M(!0)},tooltip:{content:{side:"bottom",text:_?void 0:"You need additional permissions to create custom reports"}},children:"New custom report"})}),B.length>0?(0,n.jsxs)("div",{children:[(0,n.jsx)(C.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:"Your custom reports"})}),B.map(e=>(0,n.jsx)(I,{item:e,pageKey:r,onSelectEdit:()=>{L(e.report)},onSelectDelete:()=>{F(e.report),k(!0)}},e.id))]}):null,H.map(e=>(0,n.jsx)("div",{children:e.items?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.Ay.Group,{title:(0,n.jsx)("span",{className:"uppercase font-mono",children:e.title})}),(0,n.jsx)("div",{className:"flex flex-col",children:e.items.map(e=>(0,n.jsx)("li",{className:(0,E.cn)("pr-2 mt-1 text-foreground-light group-hover:text-foreground/80 text-sm","flex items-center justify-between rounded-md group relative",e.key===r?"bg-surface-300 text-foreground":"hover:bg-surface-200"),children:(0,n.jsx)(c(),{href:e.url,className:"flex-grow h-7 flex items-center pl-3",children:e.name})},e.key))},e.key)]}):null},e.key+"-menu-group")),(0,n.jsx)(j,{onCancel:()=>L(void 0),selectedReport:P,initialValues:{name:(null==P?void 0:P.name)||"",description:(null==P?void 0:P.description)||""}}),(0,n.jsx)(w.A,{title:"Delete custom report",confirmLabel:"Delete report",confirmLabelLoading:"Deleting report",size:"medium",loading:f,visible:T,onCancel:()=>k(!1),onConfirm:()=>void 0===s?console.error("Project ref is required"):(null==D?void 0:D.id)===void 0?console.error("Report ID is required"):void y({projectRef:s,ids:[D.id]}),children:(0,n.jsx)("div",{className:"text-sm text-foreground-light grid gap-4",children:(0,n.jsx)("div",{className:"grid gap-1",children:(0,n.jsxs)("p",{children:["Are you sure you want to delete '",null==D?void 0:D.name,"'?"]})})})}),(0,n.jsx)(h.E,{visible:O,onCancel:()=>M(!1),afterSubmit:()=>M(!1)})]})})},F=(0,a.r)(e=>{let{title:t,children:s}=e;return(0,n.jsx)(r.A,{title:t,product:"Reports",productMenu:(0,n.jsx)(D,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"ReportsLayout","data-sentry-source-file":"ReportsLayout.tsx",children:s})})},72793:(e,t,s)=>{s.d(t,{E:()=>h});var n=s(80263),a=s(52385),r=s(73969),o=s(83041),i=s(83634),l=s(90206),c=s(11649),d=s(55335),u=s(80109),m=s(71171),p=s(16601);let h=e=>{var t;let{visible:s,onCancel:h,afterSubmit:_}=e,x=(0,a.useRouter)(),{profile:g}=(0,c.xc)(),y=(0,i.KT)(),f=null!=(t=null==y?void 0:y.ref)?t:"default",{mutate:j,isLoading:b}=(0,o.v)({onSuccess:(e,t)=>{r.oR.success("Successfully created new report");let s=t.payload.id;x.push("/project/".concat(f,"/reports/").concat(s)),_()},onError:e=>{r.oR.error("Failed to create report: ".concat(e.message))}});async function v(e){let{name:t,description:s}=e;return f?g?void j({projectRef:f,payload:{id:(0,l.gZ)(),type:"report",name:t,description:s||"",visibility:"project",owner_id:null==g?void 0:g.id,content:{schema_version:1,period_start:{time_period:"7d",date:""},period_end:{time_period:"today",date:""},interval:"1d",layout:[]}}}):console.error("Profile is required"):console.error("Project ref is required")}return(0,n.jsx)(d.A,{visible:s,onCancel:h,hideFooter:!0,header:"Create a custom report",size:"small","data-sentry-element":"Modal","data-sentry-component":"CreateReportModal","data-sentry-source-file":"CreateReportModal.tsx",children:(0,n.jsx)(u.A,{onReset:h,validateOnBlur:!0,initialValues:{name:"",description:""},validate:e=>{let t={};return e.name||(t.name="Required"),t},onSubmit:e=>v(e),"data-sentry-element":"Form","data-sentry-source-file":"CreateReportModal.tsx",children:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.A.Content,{className:"space-y-4",children:[(0,n.jsx)(m.A,{label:"Name",id:"name",name:"name"}),(0,n.jsx)(m.A.TextArea,{label:"Description",id:"description",placeholder:"Describe your custom report",size:"medium",textAreaClassName:"resize-none"})]}),(0,n.jsx)(d.A.Separator,{}),(0,n.jsxs)(d.A.Content,{className:"flex items-center justify-end gap-2",children:[(0,n.jsx)(p.$,{htmlType:"reset",type:"default",onClick:h,disabled:b,children:"Cancel"}),(0,n.jsx)(p.$,{htmlType:"submit",loading:b,disabled:b,children:"Create report"})]})]})})})}},77153:(e,t,s)=>{s.d(t,{N:()=>n});var n=function(e){return e.API="api",e.STORAGE="storage",e.AUTH="auth",e.QUERY_PERFORMANCE="query_performance",e.DATABASE="database",e}({})},78512:(e,t,s)=>{s.d(t,{D:()=>i});var n=s(56947),a=s(3807),r=s(51696);async function o(e,t){let{projectRef:s,type:n,name:r,limit:o=10}=e;if(void 0===s)throw Error("projectRef is required for getContent");let{data:i,error:l}=await (0,a.Jt)("/platform/projects/{ref}/content",{params:{path:{ref:s},query:{type:n,name:r,limit:o.toString()}},signal:t});return l&&(0,a.H4)(l),{cursor:i.cursor,content:i.data}}let i=function(e){let{projectRef:t,type:s,name:a,limit:i}=e,{enabled:l=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.M.list(t,{type:s,name:a,limit:i}),e=>{let{signal:n}=e;return o({projectRef:t,type:s,name:a,limit:i},n)},{enabled:l&&void 0!==t,...c})}},80109:(e,t,s)=>{s.d(t,{A:()=>l});var n=s(80263),a=s(53239),r=s(92809),o=s(34214);function i(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function l(e){let{validate:t,...s}=e,[l,c]=(0,a.useReducer)(i,null),d=(0,r.Wx)({validateOnBlur:!0,...s,validationSchema:s.validationSchema,initialValues:s.initialValues,onSubmit:s.onSubmit,validate:t||function(){return l}});return(0,n.jsx)("form",{id:s.id,name:s.name,onSubmit:d.handleSubmit,className:s.className,style:s.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,n.jsx)(o.h,{values:d.values,errors:d.errors,formContextOnChange:d.handleChange,handleBlur:d.handleBlur,touched:d.touched,fieldLevelValidation:function(e,t){c({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:s.children({errors:d.errors,touched:d.touched,isSubmitting:d.isSubmitting,isValidating:d.isValidating,submitCount:d.submitCount,initialValues:d.initialValues,values:d.values,handleReset:d.handleReset,resetForm:d.resetForm,setFieldValue:d.setFieldValue})})})}},80369:(e,t,s)=>{s.d(t,{A:()=>i});var n=s(80263),a=s(58289),r=s(10170),o=s(2);let i=e=>{let{children:t}=e,s=(0,a.xd)(),{editorPanel:i}=(0,r.qM)();return(0,n.jsx)("div",{className:(0,o.cn)("flex flex-col gap-4 px-5 py-6 mx-auto 1xl:px-28 lg:px-16 2xl:px-32 w-full",s.open||i.open?"xl:px-6":"xl:px-22"),"data-sentry-component":"ReportPadding","data-sentry-source-file":"ReportPadding.tsx",children:t})}},81737:(e,t,s)=>{s.d(t,{$:()=>c});var n=s(32144),a=s(80251),r=s(73969),o=s(3807),i=s(51696);async function l(e,t){let{projectRef:s,ids:n}=e,{data:a,error:r}=await (0,o.yH)("/platform/projects/{ref}/content",{headers:{Version:"2"},params:{path:{ref:s},query:{ids:n}},signal:t});return r&&(0,o.H4)(r),a.map(e=>e.id)}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=(0,n.jE)();return(0,a.n)(e=>l(e),{async onSuccess(t,s,n){let{projectRef:a}=s;await o.invalidateQueries(i.M.allContentLists(a)),await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?r.oR.error("Failed to delete contents: ".concat(e.message)):t(e,s,n)},...s})}},83455:(e,t,s)=>{s.d(t,{A:()=>c});var n=s(80263),a=s(3732),r=s(16601),o=s(90235),i=s(2743),l=s(37427);let c=e=>{let{format:t,highlightedValue:s,highlightedLabel:c,title:d,minimalHeader:u=!1,hideChartType:m=!1,chartStyle:p="bar",onChartStyleChange:h,showMaxValue:_=!1,setShowMaxValue:x}=e,g=(0,n.jsx)("h3",{className:"text-foreground-lighter "+(u?"text-xs":"text-sm"),children:d}),y=(0,n.jsxs)("h4",{className:"text-foreground text-xl font-normal ".concat(u?"text-base":"text-2xl"),children:[void 0!==s&&s,"seconds"===t?" ":"",(0,n.jsx)("span",{className:"text-lg",children:"function"==typeof t?t(s):t})]}),f=(0,n.jsx)("h4",{className:"text-foreground-lighter text-xs",children:c});return u?(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-4",style:{minHeight:"1.8rem"},children:[d&&g,(0,n.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[void 0!==s&&y,f]})]}):(0,n.jsxs)("div",{className:"flex-grow flex justify-between items-start min-h-16","data-sentry-component":"ChartHeader","data-sentry-source-file":"ChartHeader.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[d&&g,void 0!==s&&y,f]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[!m&&h&&(0,n.jsxs)(a.m_,{children:[(0,n.jsx)(a.k$,{asChild:!0,children:(0,n.jsx)(r.$,{type:"default",className:"px-1.5",icon:"bar"===p?(0,n.jsx)(o.A,{}):(0,n.jsx)(i.A,{}),onClick:()=>h("bar"===p?"line":"bar")})}),(0,n.jsxs)(a.ZI,{side:"left",align:"center",children:["View as ","bar"===p?"line chart":"bar chart"]})]}),x&&(0,n.jsxs)(a.m_,{children:[(0,n.jsx)(a.k$,{asChild:!0,children:(0,n.jsx)(r.$,{type:_?"default":"dashed",className:"px-1.5",icon:(0,n.jsx)(l.A,{className:_?"text-foreground":"text-foreground-lighter"}),onClick:()=>x(!_)})}),(0,n.jsxs)(a.ZI,{side:"left",align:"center",children:[_?"Hide":"Show"," limit"]})]})]})]})}},84430:(e,t,s)=>{s.d(t,{BY:()=>x,Eg:()=>u,XO:()=>p,bk:()=>h,dQ:()=>_});var n=s(80263),a=s(53434),r=s.n(a),o=s(37361),i=s.n(o),l=s(53239),c=s(62099),d=s(9603);r().extend(i());let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return m(e)?p(e,t):e.toLocaleString()},m=e=>String(e).includes("."),p=(e,t)=>{if(!m(e))return e.toLocaleString()+"."+"0".repeat(t);{let[s,n]=String(e).split(".");return Number(s).toLocaleString()+"."+n.slice(0,t)}},h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.C_.FULL,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return s?r().utc(e).format(t):r()(e).format(t)},_=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tiny:76,small:96,normal:160,large:280},s=t[e];return{Container:(0,l.useMemo)(()=>e=>{let{className:t,children:a}=e;return(0,n.jsx)(c.u,{className:t,height:s,minHeight:s,width:"100%",children:a})},[e]),minHeight:s}},x=e=>{let{data:t,xAxisKey:s,yAxisKey:n,stackKey:a,variant:r="values"}=e,o=(0,l.useMemo)(()=>t?Object.entries(t.reduce((e,t)=>{let r=t[s],o=t[n],i=t[a];return e[r]||(e[r]={}),e[r][i]=o,e},{})).map(e=>{let[t,n]=e;return{...n,[s]:Number.isNaN(Number(t))?t:Number(t)}}):[],[JSON.stringify(t)]),i=(0,l.useMemo)(()=>Object.keys(o[0]||{}).filter(e=>e!==s&&e!==n).sort(),[JSON.stringify(o[0]||{})]),c=(0,l.useMemo)(()=>{if("percentages"===r)return o.map(e=>{let t=Object.entries(e),s=t.filter(e=>{let[t,s]=e;return i.includes(t)}).reduce((e,t)=>{let[s,n]=t;return e+n},0);return t.reduce((e,t)=>{let[n,a]=t;return i.includes(n)?{...e,[n]:0!==a?a/s:0}:{...e,[n]:a}},{})})},[JSON.stringify(o)]);return{dataKeys:i,stackedData:o,percentagesStackedData:c}}}}]);